---
title: "Mali - Labels harmonization"
author: "Giovanni GADO, Bassirou COMPAORE et MOUSSA MAHAMADOU Oumar Farouk"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: true
    code_folding: show
    keep_md: true
---



```{r setup, include=FALSE, results = 'hide'}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE,
  results = "hide"
)
```


```{r packages needed}
library(haven)
library(labelled) # for general functions to work with labelled data
library(tidyverse) # general wrangling
library(dplyr)
library(Hmisc)
library(gtsummary) # to demonstrate automatic use of variable labels in summary tables
library(readxl)
library(foreign)
library(sjPlot)
library(sjmisc)
library(sjlabelled) # for example efc data set with variable labels
library(stringr)
```



```{r remove environment variables}

rm(list = ls())
```

```{r environment settings}
dir_input_data = "C:/Users/ASUS/Desktop/ISEP 3/Statistique exploratoire spatiale/Projet_1/Data/input_data"
dir_output_data = "C:/Users/ASUS/Desktop/ISEP 3/Statistique exploratoire spatiale/Projet_1/Data/output_data"

```

```{r read harmonization excel file}

Mali_Harmonization_variables <- read_excel(paste0(dir_input_data,"/MLI_Harmonization.xlsx"), 
    sheet = "variables_harmonization")
#View(Mali_Harmonization_variables)

Mali_Harmonization_description <- read_excel(paste0(dir_input_data,"/MLI_Harmonization.xlsx"), 
    sheet = "description")
#View(Mali_Harmonization_description)
```


```{r data importation}

lst_test = Mali_Harmonization_description$Name

for (i in 1:length(lst_test)) {
  file_path = file.path(dir_output_data, paste0(lst_test[i], ".sav"))
  
  if (!file.exists(file_path)) {
    print(paste0("Le fichier ", lst_test[i], ".sav n'existe pas"))
  } else {
    assign(lst_test[i], read_sav(file_path))
  }
}


```


# Data consistency  Check

## Drop duplicated observations

```{r}
table(Mali_baseline_2018$ADMIN1Name)
table(Mali_ea_2020$ADMIN1Name)
table(Mali_ea_2021$ADMIN1Name)
table(Mali_ea_2022$ADMIN1Name)
table(Mali_pdm_2022$ADMIN1Name)
```


```{r}
Mali_baseline_2018 <- Mali_baseline_2018 %>% dplyr::distinct() %>% dplyr::filter(!is.na(ADMIN1Name))
Mali_ea_2020 <- Mali_ea_2020 %>% dplyr::distinct() %>% dplyr::filter(!is.na(ADMIN1Name))
Mali_ea_2021 <- Mali_ea_2021 %>% dplyr::distinct() %>% dplyr::filter(!is.na(ADMIN1Name))
Mali_ea_2022 <- Mali_ea_2022 %>% dplyr::distinct() %>% dplyr::filter(!is.na(ADMIN1Name))
Mali_pdm_2022 <- Mali_pdm_2022 %>% dplyr::distinct() %>% dplyr::filter(!is.na(ADMIN1Name))
```

## Consent check

```{r}
table(Mali_baseline_2018$RESPConsent)
table(Mali_ea_2020$RESPConsent)
table(Mali_ea_2021$RESPConsent)
table(Mali_ea_2022$RESPConsent)
table(Mali_pdm_2022$RESPConsent)
```


```{r}
Mali_baseline_2018 <- Mali_baseline_2018  %>% filter(RESPConsent == 1)
Mali_ea_2020 <- Mali_ea_2020  %>% filter(RESPConsent == 1)
Mali_ea_2021 <- Mali_ea_2021  %>% filter(RESPConsent == 1)
Mali_ea_2022 <- Mali_ea_2022 %>% filter(RESPConsent == "Oui")
Mali_pdm_2022 <- Mali_pdm_2022 %>% filter(RESPConsent == "Oui")
```

## ID Check 

```{r}
Mali_baseline_2018 <- Mali_baseline_2018 %>% dplyr::distinct(ID,.keep_all = TRUE) %>% dplyr::filter(!is.na(ID))
Mali_ea_2020 <- Mali_ea_2020 %>% dplyr::distinct(ID,.keep_all = TRUE) %>% dplyr::filter(!is.na(ID))
Mali_ea_2021 <- Mali_ea_2021 %>% dplyr::distinct(ID,.keep_all = TRUE) %>% dplyr::filter(!is.na(ID))
Mali_ea_2022 <- Mali_ea_2022 %>% dplyr::distinct(ID,.keep_all = TRUE) %>% dplyr::filter(!is.na(ID))
Mali_pdm_2022 <- Mali_pdm_2022 %>% dplyr::distinct(ID,.keep_all = TRUE) %>% dplyr::filter(!is.na(ID))
```

# Administrative check

```{r}
Mali_baseline_2018 = Mali_baseline_2018 %>%
  dplyr::mutate(YEAR= "2018" %>% 
                  structure(label = "Annee"))

Mali_baseline_2018 = Mali_baseline_2018 %>%
  dplyr::mutate(SURVEY= "Baseline" %>% 
                  structure(label = "Type d'enquête"))

Mali_baseline_2018 = Mali_baseline_2018 %>%
  dplyr::mutate(ADMIN0Name= "Mali" %>% 
                  structure(label = "Nom du pays"))
Mali_baseline_2018 = Mali_baseline_2018 %>%
  dplyr::mutate(adm0_ocha= "ML" %>% 
                  structure(label = "Admin 0 ID"))


Mali_baseline_2018 = Mali_baseline_2018 %>%
  dplyr::mutate(adm1_ocha=case_when(
    ADMIN1Name == "Gao" ~ "ML07",
    ADMIN1Name == "Koulikoro" ~ "ML02",
    ADMIN1Name == "Menaka" ~ "ML10",
    ADMIN1Name == "Mopti" ~ "ML05",
    ADMIN1Name == "Tombouctou" ~ "ML06",

    TRUE ~ as.character(ADMIN1Name)
  )%>% 
    structure(label = "Admin 1 ID"))


Mali_baseline_2018 = Mali_baseline_2018 %>%
  dplyr::mutate(ADMIN2Name=case_when(
    ADMIN2Name  ==  "Gourma_Rharous"  ~  "Gourma-Rharous",
    ADMIN2Name  ==  "Tomboutou"  ~  "Tombouctou",
    
    TRUE ~ as.character(ADMIN2Name)))

Mali_baseline_2018 = Mali_baseline_2018 %>%
  dplyr::mutate(adm2_ocha=case_when(
    ADMIN2Name  ==  "Badiangara"  ~  "ML0501",
    ADMIN2Name  ==  "Gao"  ~  "ML0703",
    ADMIN2Name  ==  "Gourma-Rharous"  ~  "ML0603",
    ADMIN2Name  ==  "Kolokani"  ~  "ML0205",
    ADMIN2Name  ==  "Menaka"  ~  "ML1001",
    ADMIN2Name  ==  "Mopti"  ~  "ML0506",
    ADMIN2Name  ==  "Niafunke"  ~  "ML0604",
    ADMIN2Name  ==  "Tombouctou"  ~  "ML0605",

    TRUE ~ as.character(ADMIN2Name)
  )%>% 
    structure(label =  "Admin 2 ID"))

```



```{r TCD EA 2022  OCHA - Subnational Edge-matched Administrative Boundaries}
Mali_ea_2020 = Mali_ea_2020 %>%
  dplyr::mutate(YEAR= "2020" %>% 
                  structure(label = "Annee"))

Mali_ea_2020 = Mali_ea_2020 %>%
  dplyr::mutate(SURVEY= "Enquête annuelle" %>% 
                  structure(label = "Type d'enquête"))

Mali_ea_2020 = Mali_ea_2020 %>%
  dplyr::mutate(ADMIN0Name= "Mali" %>% 
    structure(label = "Nom du pays"))

Mali_ea_2020 = Mali_ea_2020 %>%
  dplyr::mutate(adm0_ocha= "ML" %>% 
                  structure(label = "Admin 0 ID"))


Mali_ea_2020 = Mali_ea_2020 %>%
  dplyr::mutate(adm1_ocha=case_when(
    ADMIN1Name == "Gao" ~ "ML07",
    ADMIN1Name == "Koulikoro" ~ "ML02",
    ADMIN1Name == "Menaka" ~ "ML10",
    ADMIN1Name == "Mopti" ~ "ML05",
    ADMIN1Name == "Tombouctou" ~ "ML06",

    TRUE ~ as.character(ADMIN1Name)
  )%>% 
    structure(label = "Admin 1 ID"))


Mali_ea_2020 = Mali_ea_2020 %>%
  dplyr::mutate(ADMIN2Name=case_when(
    ADMIN2Name  ==  "Gourma_Rharous"  ~  "Gourma-Rharous",

    TRUE ~ as.character(ADMIN2Name)))



Mali_ea_2020 = Mali_ea_2020 %>%
  dplyr::mutate(adm2_ocha=case_when(
    ADMIN2Name == "Ansongo" ~ "ML0701",
    ADMIN2Name == "Bandiagara" ~ "ML0501",
    ADMIN2Name == "Bankass" ~ "ML0502",
    ADMIN2Name == "Dire" ~ "ML0601",
    ADMIN2Name == "Gao" ~ "ML0703",
    ADMIN2Name == "Goundam" ~ "ML0602",
    ADMIN2Name == "Gourma-Rharous" ~ "ML0603",
    ADMIN2Name == "Kolokani" ~ "ML0205",
    ADMIN2Name == "Koro" ~ "ML0505",
    ADMIN2Name == "Menaka" ~ "ML1001",
    ADMIN2Name == "Mopti" ~ "ML0506",
    ADMIN2Name == "Niafunke" ~ "ML0604",
    ADMIN2Name == "Tombouctou" ~ "ML0605",
    TRUE ~ as.character(ADMIN2Name)
  )%>% 
    structure(label = "Admin 2 ID"))

```



```{r TCD PDM 2022  OCHA - Subnational Edge-matched Administrative Boundaries}
Mali_ea_2021 = Mali_ea_2021 %>%
  dplyr::mutate(YEAR= "2021" %>% 
                  structure(label = "Annee"))

Mali_ea_2021 = Mali_ea_2021 %>%
  dplyr::mutate(SURVEY= "Enquête annuelle" %>% 
                  structure(label = "Type d'enquête"))

Mali_ea_2021 = Mali_ea_2021 %>%
  dplyr::mutate(ADMIN0Name= "Mali" %>% 
    structure(label = "Nom du pays"))

Mali_ea_2021 = Mali_ea_2021 %>%
  dplyr::mutate(adm0_ocha= "ML" %>% 
                  structure(label = "Admin 0 ID"))


Mali_ea_2021 = Mali_ea_2021 %>%
  dplyr::mutate(ADMIN1Name=case_when(
    ADMIN1Name == "mli004" ~ "Segou",
    ADMIN1Name == "mli005" ~ "Mopti",
    ADMIN1Name == "mli006" ~ "Tombouctou",
    ADMIN1Name == "mli007" ~ "Gao",
    
    TRUE ~ as.character(ADMIN1Name)))



Mali_ea_2021 = Mali_ea_2021 %>%
  dplyr::mutate(adm1_ocha=case_when(
    ADMIN1Name == "Segou" ~ "ML04",
    ADMIN1Name == "Mopti" ~ "ML05",
    ADMIN1Name == "Tombouctou" ~ "ML06",
    ADMIN1Name == "Gao" ~ "ML07",

    TRUE ~ as.character(ADMIN1Name)
  )%>% 
    structure(label = "Admin 1 ID"))


Mali_ea_2021 = Mali_ea_2021 %>%
  dplyr::mutate(ADMIN2Name=case_when(
    ADMIN2Name == "mli004001" ~ "Segou",
    ADMIN2Name == "mli004002" ~ "Baraoueli",
    ADMIN2Name == "mli004003" ~ "Bla",
    ADMIN2Name == "mli004004" ~ "Macina",
    ADMIN2Name == "mli004005" ~ "Niono",
    ADMIN2Name == "mli004006" ~ "San",
    ADMIN2Name == "mli004007" ~ "Tominian",
    ADMIN2Name == "mli005001" ~ "Mopti",
    ADMIN2Name == "mli005002" ~ "Bandiagara",
    ADMIN2Name == "mli005003" ~ "Bankass",
    ADMIN2Name == "mli005004" ~ "Djenne",
    ADMIN2Name == "mli005005" ~ "Douentza",
    ADMIN2Name == "mli005006" ~ "Koro",
    ADMIN2Name == "mli005007" ~ "Tenenkou",
    ADMIN2Name == "mli005008" ~ "Youwarou",
    ADMIN2Name == "mli006001" ~ "Tombouctou",
    ADMIN2Name == "mli006002" ~ "Dire",
    ADMIN2Name == "mli006003" ~ "Goundam",
    ADMIN2Name == "mli006004" ~ "Gourma-Rharous",
    ADMIN2Name == "mli006005" ~ "Niafunke",
    ADMIN2Name == "mli007001" ~ "Gao",
    ADMIN2Name == "mli007002" ~ "Ansongo",
    ADMIN2Name == "mli007003" ~ "Bourem",
    ADMIN2Name == "mli007004" ~ "Menaka",


    TRUE ~ as.character(ADMIN2Name)))


Mali_ea_2021 = Mali_ea_2021 %>%
  dplyr::mutate(adm2_ocha=case_when(
    ADMIN2Name == "Segou" ~ "ML0406",
    ADMIN2Name == "Baraoueli" ~ "ML0401",
    ADMIN2Name == "Bla" ~ "ML0402",
    ADMIN2Name == "Macina" ~ "ML0403",
    ADMIN2Name == "Niono" ~ "ML0404",
    ADMIN2Name == "San" ~ "ML0405",
    ADMIN2Name == "Tominian" ~ "ML0407",
    ADMIN2Name == "Mopti" ~ "ML0506",
    ADMIN2Name == "Bandiagara" ~ "ML0501",
    ADMIN2Name == "Bankass" ~ "ML0502",
    ADMIN2Name == "Djenne" ~ "ML0503",
    ADMIN2Name == "Douentza" ~ "ML0504",
    ADMIN2Name == "Koro" ~ "ML0505",
    ADMIN2Name == "Tenenkou" ~ "ML0507",
    ADMIN2Name == "Youwarou" ~ "ML0508",
    ADMIN2Name == "Tombouctou" ~ "ML0605",
    ADMIN2Name == "Dire" ~ "ML0601",
    ADMIN2Name == "Goundam" ~ "ML0602",
    ADMIN2Name == "Gourma-Rharous" ~ "ML0603",
    ADMIN2Name == "Niafunke" ~ "ML0604",
    ADMIN2Name == "Gao" ~ "ML0703",
    ADMIN2Name == "Ansongo" ~ "ML0701",
    ADMIN2Name == "Bourem" ~ "ML0702",
    ADMIN2Name == "Menaka" ~ "ML1001",


    TRUE ~ as.character(ADMIN2Name)
  )%>% 
    structure(label = "Admin 2 ID"))

```


```{r TCD PDM 2022  OCHA - Subnational Edge-matched Administrative Boundaries}
Mali_ea_2022 = Mali_ea_2022 %>%
  dplyr::mutate(YEAR= "2022" %>% 
                  structure(label = "Annee"))

Mali_ea_2022 = Mali_ea_2022 %>%
  dplyr::mutate(SURVEY= "Enquête annuelle" %>% 
                  structure(label = "Type d'enquête"))

Mali_ea_2022 = Mali_ea_2022 %>%
  dplyr::mutate(ADMIN0Name= "Mali" %>% 
    structure(label = "Nom du pays"))

Mali_ea_2022 = Mali_ea_2022 %>%
  dplyr::mutate(adm0_ocha= "ML" %>% 
                  structure(label = "Admin 0 ID"))

Mali_ea_2022 = Mali_ea_2022 %>%
  dplyr::mutate(ADMIN1Name=case_when(
    ADMIN1Name == "Timbuktu" ~ "Tombouctou",
    TRUE ~ as.character(ADMIN1Name)))

Mali_ea_2022 = Mali_ea_2022 %>%
  dplyr::mutate(adm1_ocha=case_when(
    ADMIN1Name == "Gao" ~ "ML07",
    ADMIN1Name == "Menaka" ~ "ML10",
    ADMIN1Name == "Mopti" ~ "ML05",
    ADMIN1Name == "Segou" ~ "ML04",
    ADMIN1Name == "Tombouctou" ~ "ML06",

    TRUE ~ as.character(ADMIN1Name)
  )%>% 
    structure(label = "Admin 1 ID"))


Mali_ea_2022 = Mali_ea_2022 %>%
  dplyr::mutate(ADMIN2Name=case_when(
    ADMIN2Name == "ANSONGO" ~ "Ansongo",
    ADMIN2Name == "BANDIAGARA" ~ "Bandiagara",
    ADMIN2Name == "BARAOUELI" ~ "Baraoueli",
    ADMIN2Name == "GAO" ~ "Gao",
    ADMIN2Name == "GOURMA-RHAROUS" ~ "Gourma-Rharous",
    ADMIN2Name == "MENAKA" ~ "Menaka",
    ADMIN2Name == "MOPTI" ~ "Mopti",
    ADMIN2Name == "NIAFUNKE" ~ "Niafunke",
    ADMIN2Name == "NIONO" ~ "Niono",
    ADMIN2Name == "Timbuktu" ~ "Tombouctou",
    ADMIN2Name == "TOMBOUCTOU" ~ "Tombouctou",
    ADMIN2Name == "TOMINIAN" ~ "Tominian",

    TRUE ~ as.character(ADMIN2Name)))


Mali_ea_2022 = Mali_ea_2022 %>%
  dplyr::mutate(adm2_ocha=case_when(
    ADMIN2Name == "Ansongo" ~ "ML0701",
    ADMIN2Name == "Bandiagara" ~ "ML0501",
    ADMIN2Name == "Baraoueli" ~ "ML0401",
    ADMIN2Name == "Gao" ~ "ML0703",
    ADMIN2Name == "Gourma-Rharous" ~ "ML0603",
    ADMIN2Name == "Menaka" ~ "ML1001",
    ADMIN2Name == "Mopti" ~ "ML0506",
    ADMIN2Name == "Niafunke" ~ "ML0604",
    ADMIN2Name == "Niono" ~ "ML0404",
    ADMIN2Name == "Tombouctou" ~ "ML0605",
    ADMIN2Name == "Tominian" ~ "ML0407",

    
    TRUE ~ as.character(ADMIN2Name)
  )%>% 
    structure(label = "Admin 2 ID"))


```


```{r TCD PDM 2022  OCHA - Subnational Edge-matched Administrative Boundaries}
Mali_pdm_2022 = Mali_pdm_2022 %>%
  dplyr::mutate(YEAR= "2022" %>% 
                  structure(label = "Annee"))

Mali_pdm_2022 = Mali_pdm_2022 %>%
  dplyr::mutate(SURVEY= "PDM" %>% 
                  structure(label = "Type d'enquête"))

Mali_pdm_2022 = Mali_pdm_2022 %>%
  dplyr::mutate(ADMIN0Name= "Mali" %>% 
    structure(label = "Nom du pays"))

Mali_pdm_2022 = Mali_pdm_2022 %>%
  dplyr::mutate(adm0_ocha= "ML" %>% 
                  structure(label = "Admin 0 ID"))

Mali_pdm_2022 = Mali_pdm_2022 %>%
  dplyr::mutate(adm1_ocha=case_when(
    ADMIN1Name == "Gao" ~ "ML07",
    ADMIN1Name == "Menaka" ~ "ML10",
    ADMIN1Name == "Mopti" ~ "ML05",
    ADMIN1Name == "Segou" ~ "ML04",
    ADMIN1Name == "Tombouctou" ~ "ML06",

    TRUE ~ as.character(ADMIN1Name)
  )%>% 
    structure(label = "Admin 1 ID"))


Mali_pdm_2022 = Mali_pdm_2022 %>%
  dplyr::mutate(ADMIN2Name=case_when(
    ADMIN2Name == "ANSONGO" ~ "Ansongo",
    ADMIN2Name == "BANDIAGARA" ~ "Bandiagara",
    ADMIN2Name == "BARAOUELI" ~ "Baraoueli",
    ADMIN2Name == "GAO" ~ "Gao",
    ADMIN2Name == "GOURMA-RHAROUS" ~ "Gourma-Rharous",
    ADMIN2Name == "MENAKA" ~ "Menaka",
    ADMIN2Name == "MOPTI" ~ "Mopti",
    ADMIN2Name == "NIAFUNKE" ~ "Niafunke",
    ADMIN2Name == "TOMBOUCTOU" ~ "Tombouctou",

    TRUE ~ as.character(ADMIN2Name)))


Mali_pdm_2022 = Mali_pdm_2022 %>%
  dplyr::mutate(adm2_ocha=case_when(
    ADMIN2Name == "Ansongo" ~ "ML0701",
    ADMIN2Name == "Bandiagara" ~ "ML0501",
    ADMIN2Name == "Baraoueli" ~ "ML0401",
    ADMIN2Name == "Gao" ~ "ML0703",
    ADMIN2Name == "Gourma-Rharous" ~ "ML0603",
    ADMIN2Name == "Menaka" ~ "ML1001",
    ADMIN2Name == "Mopti" ~ "ML0506",
    ADMIN2Name == "Niafunke" ~ "ML0604",
    ADMIN2Name == "Tombouctou" ~ "ML0605",
    
    TRUE ~ as.character(ADMIN2Name)
  )%>% 
    structure(label = "Admin 2 ID"))


```


# Indicator checks

## Food consumption score

The Food consumption Score (FCS) is an index that aggregates household-level data on the diversity and frequency of food groups consumed over the last 7 days. It is then weighted according to the relative nutritional value of the consumed food groups. Food groups containing nutritionally dense foods (e.g. animal based products) are given greater weight than those containing less nutritional value (e.g. tubers) as follows: (main staples:2, pulses:3, vegetables:1, fruit:1, meat or fish:4, milk:4, sugar:0.5, oil:0.5).

### FCS : Céréales et tubercules

```{r FCS Staple}
#expss::val_lab(Mali_baseline_2018$FCSStap)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSStap,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSStap,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSStap,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSStap,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSStap,show.na = T)

```

### FCS : Céréales et tubercules - Sources

```{r FCS  Source ref }
# Codes d’acquisition des aliments 
# 1 = Production propre (récoltes, élevage) ; 2 = Pêche / Chasse ; 3 = Cueillette ; 4 = Prêts ; 5 = Marché (achat avec des espèces) ; 6 = Marché (achat à crédit) ;
# 7 = Mendicité ; 8 = Troc travail ou biens contre des aliments ; 9 = Dons (aliments) de membres de la famille ou d’amis ; 10 = Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc.

```


```{r FCS Staple Source}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$FCSStapSRf)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSStapSRf,show.na = T)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate_at(c("FCSStapSRf"),recode,"1"=1,"2"=1,"3"=1,"4"=5,"5"=10,"6"=10,"7"=9,"8"=6,"9"=2,"10"=8)

Mali_baseline_2018$FCSStapSRf <- labelled::labelled(Mali_baseline_2018$FCSStapSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_baseline_2018$FCSStapSRf)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,FCSStapSRf,show.na = T)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$FCSStapSRf)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSStapSRf,show.na = T)

Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate_at(c("FCSStapSRf"),recode,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=6,"7"=7,"8"=8,"9"=9,"10"=10)

Mali_ea_2020$FCSStapSRf <- labelled::labelled(Mali_ea_2020$FCSStapSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2020$FCSStapSRf)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,FCSStapSRf,show.na = T)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$FCSStapSRf)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSStapSRf,show.na = T)

Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("FCSStapSRf"),recode,"100"=1,"200"=2,"300"=3,"400"=4,"500"=5,"600"=6,"700"=7,"800"=8,"900"=9,"1000"=10)

Mali_ea_2021$FCSStapSRf <- labelled::labelled(Mali_ea_2021$FCSStapSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2021$FCSStapSRf)
Mali_ea_2021 %>%
  plot_frq(coord.flip =T,FCSStapSRf,show.na = T)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$FCSStapSRf)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSStapSRf,show.na = T)

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("FCSStapSRf"),recode,"Production propre (récoltes, élevage)"=1,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_ea_2022$FCSStapSRf <- labelled::labelled(Mali_ea_2022$FCSStapSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2022$FCSStapSRf)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,FCSStapSRf,show.na = T)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$FCSStapSRf)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSStapSRf,show.na = T)

Mali_pdm_2022 <- 
  Mali_pdm_2022 %>% dplyr::mutate_at(c("FCSStapSRf"),recode,"Production propre (récoltes, élevage)"=1,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_pdm_2022$FCSStapSRf <- labelled::labelled(Mali_pdm_2022$FCSStapSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_pdm_2022$FCSStapSRf)
Mali_pdm_2022 %>%
  plot_frq(coord.flip =T,FCSStapSRf,show.na = T)

```


### FCS : Légumineuses

```{r FCS Pulses}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPulse,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPulse,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPulse,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPulse,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPulse,show.na = T)
```


### FCS : Légumineuses - Sources

```{r FCS Pulses Sources,error=TRUE}
#Base Mali_baseline_2018

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate_at(c("FCSPulseSRf"),recode,"1"=1,"2"=1,"3"=1,"4"=5,"5"=10,"6"=10,"7"=9,"8"=6,"9"=2,"10"=8)

Mali_baseline_2018$FCSPulseSRf <- labelled::labelled(Mali_baseline_2018$FCSPulseSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette= 3,`Prêts`=4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))

expss::val_lab(Mali_baseline_2018$FCSPulseSRf)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,FCSPulseSRf,show.na = T)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$FCSPulseSRf)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPulseSRf,show.na = T)

Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate_at(c("FCSPulseSRf"),recode,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=6,"7"=7,"8"=8,"9"=9,"10"=10)

Mali_ea_2020$FCSPulseSRf <- labelled::labelled(Mali_ea_2020$FCSPulseSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2020$FCSPulseSRf)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,FCSPulseSRf,show.na = T)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$FCSPulseSRf)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPulseSRf,show.na = T)

Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("FCSPulseSRf"),recode,"100"=1,"200"=2,"300"=3,"400"=4,"500"=5,"600"=6,"700"=7,"800"=8,"900"=9,"1000"=10)

Mali_ea_2021$FCSPulseSRf <- labelled::labelled(Mali_ea_2021$FCSPulseSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2021$FCSPulseSRf)
Mali_ea_2021 %>%
  plot_frq(coord.flip =T,FCSPulseSRf,show.na = T)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$FCSPulseSRf)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPulseSRf,show.na = T)

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("FCSPulseSRf"),recode,"Production propre (récoltes, élevage)"=1,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_ea_2022$FCSPulseSRf <- labelled::labelled(Mali_ea_2022$FCSPulseSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2022$FCSPulseSRf)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,FCSPulseSRf,show.na = T)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$FCSPulseSRf)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPulseSRf,show.na = T)

Mali_pdm_2022 <- 
  Mali_pdm_2022 %>% dplyr::mutate_at(c("FCSPulseSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_pdm_2022$FCSPulseSRf <- labelled::labelled(Mali_pdm_2022$FCSPulseSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_pdm_2022$FCSPulseSRf)
Mali_pdm_2022 %>%
  plot_frq(coord.flip =T,FCSPulseSRf,show.na = T)


```


### FCS : Lait et produits laitiers

```{r FCS Dairy}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairy,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairy,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairy,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairy,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairy,show.na = T)
```


### FCS : Lait et produits laitiers - Sources

```{r FCS Dairy Sources}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$FCSDairySRfSRf)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairySRf,show.na = T)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate_at(c("FCSDairySRf"),recode,"1"=1,"2"=1,"3"=1,"4"=5,"5"=10,"6"=10,"7"=9,"8"=6,"9"=2,"10"=8)

Mali_baseline_2018$FCSDairySRf <- labelled::labelled(Mali_baseline_2018$FCSDairySRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette= 3,`Prêts`=4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))

expss::val_lab(Mali_baseline_2018$FCSDairySRf)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,FCSDairySRf,show.na = T)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$FCSDairySRf)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairySRf,show.na = T)

Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate_at(c("FCSDairySRf"),recode,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=6,"7"=7,"8"=8,"9"=9,"10"=10)

Mali_ea_2020$FCSDairySRf <- labelled::labelled(Mali_ea_2020$FCSDairySRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2020$FCSDairySRf)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,FCSDairySRf,show.na = T)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$FCSDairySRf)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairySRf,show.na = T)

Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("FCSDairySRf"),recode,"100"=1,"200"=2,"300"=3,"400"=4,"500"=5,"600"=6,"700"=7,"800"=8,"900"=9,"1000"=10)

Mali_ea_2021$FCSDairySRf <- labelled::labelled(Mali_ea_2021$FCSDairySRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2021$FCSDairySRf)
Mali_ea_2021 %>%
  plot_frq(coord.flip =T,FCSDairySRf,show.na = T)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$FCSDairySRf)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairySRf,show.na = T)

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("FCSDairySRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_ea_2022$FCSDairySRf <- labelled::labelled(Mali_ea_2022$FCSDairySRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2022$FCSDairySRf)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,FCSDairySRf,show.na = T)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$FCSDairySRf)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSDairySRf,show.na = T)

Mali_pdm_2022 <- 
  Mali_pdm_2022 %>% dplyr::mutate_at(c("FCSDairySRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_pdm_2022$FCSDairySRf <- labelled::labelled(Mali_pdm_2022$FCSDairySRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_pdm_2022$FCSDairySRf)
Mali_pdm_2022 %>%
  plot_frq(coord.flip =T,FCSDairySRf,show.na = T)


```




### FCS: Viande, poisson et oeufs

```{r FCSPr}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPr,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPr,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPr,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPr,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPr,show.na = T)
```

### FCS: Viande, poisson et oeufs - Sources

```{r FCSPr Sources}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$FCSPrSRf)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrSRf,show.na = T)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate_at(c("FCSPrSRf"),recode,"1"=1,"2"=1,"3"=1,"4"=5,"5"=10,"6"=10,"7"=9,"8"=6,"9"=2,"10"=8)

Mali_baseline_2018$FCSPrSRf <- labelled::labelled(Mali_baseline_2018$FCSPrSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette= 3,`Prêts`=4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))

expss::val_lab(Mali_baseline_2018$FCSPrSRf)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,FCSPrSRf,show.na = T)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$FCSPrSRf)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrSRf,show.na = T)

Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate_at(c("FCSPrSRf"),recode,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=6,"7"=7,"8"=8,"9"=9,"10"=10)

Mali_ea_2020$FCSPrSRf <- labelled::labelled(Mali_ea_2020$FCSPrSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2020$FCSPrSRf)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,FCSPrSRf,show.na = T)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$FCSPrSRf)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrSRf,show.na = T)

Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("FCSPrSRf"),recode,"100"=1,"200"=2,"300"=3,"400"=4,"500"=5,"600"=6,"700"=7,"800"=8,"900"=9,"1000"=10)

Mali_ea_2021$FCSPrSRf <- labelled::labelled(Mali_ea_2021$FCSPrSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2021$FCSPrSRf)
Mali_ea_2021 %>%
  plot_frq(coord.flip =T,FCSPrSRf,show.na = T)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$FCSPrSRf)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrSRf,show.na = T)

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("FCSPrSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_ea_2022$FCSPrSRf <- labelled::labelled(Mali_ea_2022$FCSPrSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2022$FCSPrSRf)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,FCSPrSRf,show.na = T)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$FCSPrSRf)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrSRf,show.na = T)

Mali_pdm_2022 <- 
  Mali_pdm_2022 %>% dplyr::mutate_at(c("FCSPrSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_pdm_2022$FCSPrSRf <- labelled::labelled(Mali_pdm_2022$FCSPrSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_pdm_2022$FCSPrSRf)
Mali_pdm_2022 %>%
  plot_frq(coord.flip =T,FCSPrSRf,show.na = T)


```



### FCS : Chair/viande rouge

```{r FCS PrMeatF}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatF,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatF,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatF,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatF,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatF,show.na = T)
```

### FCS : Viande d'organe, telle que: (foie, reins, coeur et / ou autres abats) 


```{r FCS PrMeatO}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatO,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatO,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatO,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatO,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrMeatO,show.na = T)
```

### FCS : Poissons et coquillage, tels que: (poissons, y compris le thon en conserve, les escargots et / ou d'autres fruits de mer remplacer par des exemples localement pertinents )


```{r FCS PrFish}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrFish,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrFish,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrFish,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrFish,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrFish,show.na = T)
```


### FCS : Oeufs

```{r}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrEgg,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrEgg,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrEgg,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrEgg,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSPrEgg,show.na = T)
```


### FCS : Légumes et feuilles , tels que : (épinards, oignons, tomates, carottes, poivrons, haricots verts, laitue, etc)

```{r FCSVeg}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSVeg,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVeg,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVeg,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVeg,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVeg,show.na = T)
```

### FCS : Légumes et feuilles , tels que : (épinards, oignons, tomates, carottes, poivrons, haricots verts, laitue, etc) - Sources

```{r FCSVeg Sources}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$FCSVegSRf)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegSRf,show.na = T)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate_at(c("FCSVegSRf"),recode,"1"=1,"2"=1,"3"=1,"4"=5,"5"=10,"6"=10,"7"=9,"8"=6,"9"=2,"10"=8)

Mali_baseline_2018$FCSVegSRf <- labelled::labelled(Mali_baseline_2018$FCSVegSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette= 3,`Prêts`=4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))

expss::val_lab(Mali_baseline_2018$FCSVegSRf)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,FCSVegSRf,show.na = T)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$FCSVegSRf)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegSRf,show.na = T)

Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate_at(c("FCSVegSRf"),recode,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=6,"7"=7,"8"=8,"9"=9,"10"=10)

Mali_ea_2020$FCSVegSRf <- labelled::labelled(Mali_ea_2020$FCSVegSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2020$FCSVegSRf)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,FCSVegSRf,show.na = T)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$FCSVegSRf)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegSRf,show.na = T)

Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("FCSVegSRf"),recode,"100"=1,"200"=2,"300"=3,"400"=4,"500"=5,"600"=6,"700"=7,"800"=8,"900"=9,"1000"=10)

Mali_ea_2021$FCSVegSRf <- labelled::labelled(Mali_ea_2021$FCSVegSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2021$FCSVegSRf)
Mali_ea_2021 %>%
  plot_frq(coord.flip =T,FCSVegSRf,show.na = T)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$FCSVegSRf)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegSRf,show.na = T)

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("FCSVegSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_ea_2022$FCSVegSRf <- labelled::labelled(Mali_ea_2022$FCSVegSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2022$FCSVegSRf)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,FCSVegSRf,show.na = T)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$FCSVegSRf)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegSRf,show.na = T)

Mali_pdm_2022 <- 
  Mali_pdm_2022 %>% dplyr::mutate_at(c("FCSVegSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_pdm_2022$FCSVegSRf <- labelled::labelled(Mali_pdm_2022$FCSVegSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_pdm_2022$FCSVegSRf)
Mali_pdm_2022 %>%
  plot_frq(coord.flip =T,FCSVegSRf,show.na = T)



```


### FCS : Légumes oranges (légumes riches en Vitamine A)

```{r FCSVegOrg}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegOrg,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegOrg,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegOrg,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegOrg,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegOrg,show.na = T)
```


### FCS : Légumes à feuilles vertes,,  tels que : ( épinards, brocoli, amarante et/ou autres feuilles vert foncé , feuilles de manioc )

```{r FCSVegGre}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegGre,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegGre,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegGre,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegGre,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSVegGre,show.na = T)
```



### FCS : Fruits,  tels que : (banane, pomme, citron, mangue, papaye, abricot, pêche, etc)

```{r FCSFruit}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruit,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruit,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruit,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruit,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruit,show.na = T)
```
### FCS : Fruits,  tels que : (banane, pomme, citron, mangue, papaye, abricot, pêche, etc) - Sources

```{r FCSFruit Sources}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$FCSFruitSRf)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate_at(c("FCSFruitSRf"),recode,"1"=1,"2"=1,"3"=1,"4"=5,"5"=10,"6"=10,"7"=9,"8"=6,"9"=2,"10"=8)

Mali_baseline_2018$FCSFruitSRf <- labelled::labelled(Mali_baseline_2018$FCSFruitSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette= 3,`Prêts`=4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))

expss::val_lab(Mali_baseline_2018$FCSFruitSRf)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$FCSFruitSRf)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)

Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate_at(c("FCSFruitSRf"),recode,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=6,"7"=7,"8"=8,"9"=9,"10"=10)

Mali_ea_2020$FCSFruitSRf <- labelled::labelled(Mali_ea_2020$FCSFruitSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2020$FCSFruitSRf)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$FCSFruitSRf)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)

Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("FCSFruitSRf"),recode,"100"=1,"200"=2,"300"=3,"400"=4,"500"=5,"600"=6,"700"=7,"800"=8,"900"=9,"1000"=10)

Mali_ea_2021$FCSFruitSRf <- labelled::labelled(Mali_ea_2021$FCSFruitSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2021$FCSFruitSRf)
Mali_ea_2021 %>%
  plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$FCSFruitSRf)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("FCSFruitSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_ea_2022$FCSFruitSRf <- labelled::labelled(Mali_ea_2022$FCSFruitSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2022$FCSFruitSRf)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$FCSFruitSRf)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)

Mali_pdm_2022 <- 
  Mali_pdm_2022 %>% dplyr::mutate_at(c("FCSFruitSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_pdm_2022$FCSFruitSRf <- labelled::labelled(Mali_pdm_2022$FCSFruitSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_pdm_2022$FCSFruitSRf)
Mali_pdm_2022 %>%
  plot_frq(coord.flip =T,FCSFruitSRf,show.na = T)


```


### FCS : Huile/matières grasses/beurre: tels que (huile végétale, huile de palme, beurre de karité, margarine, autres huiles / matières grasses)

```{r FCSFat}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFat,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSFat,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSFat,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSFat,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSFat,show.na = T)
```

### FCS : Huile/matières grasses/beurre: tels que (huile végétale, huile de palme, beurre de karité, margarine, autres huiles / matières grasses) - Sources

```{r FCSFat Sources}

#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$FCSFatSRf)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFatSRf,show.na = T)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate_at(c("FCSFatSRf"),recode,"1"=1,"2"=1,"3"=1,"4"=5,"5"=10,"6"=10,"7"=9,"8"=6,"9"=2,"10"=8)

Mali_baseline_2018$FCSFatSRf <- labelled::labelled(Mali_baseline_2018$FCSFatSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette= 3,`Prêts`=4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))

expss::val_lab(Mali_baseline_2018$FCSFatSRf)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,FCSFatSRf,show.na = T)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$FCSFatSRf)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFatSRf,show.na = T)

Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate_at(c("FCSFatSRf"),recode,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=6,"7"=7,"8"=8,"9"=9,"10"=10)

Mali_ea_2020$FCSFatSRf <- labelled::labelled(Mali_ea_2020$FCSFatSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2020$FCSFatSRf)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,FCSFatSRf,show.na = T)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$FCSFatSRf)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFatSRf,show.na = T)

Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("FCSFatSRf"),recode,"100"=1,"200"=2,"300"=3,"400"=4,"500"=5,"600"=6,"700"=7,"800"=8,"900"=9,"1000"=10)

Mali_ea_2021$FCSFatSRf <- labelled::labelled(Mali_ea_2021$FCSFatSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2021$FCSFatSRf)
Mali_ea_2021 %>%
  plot_frq(coord.flip =T,FCSFatSRf,show.na = T)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$FCSFatSRf)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFatSRf,show.na = T)

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("FCSFatSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_ea_2022$FCSFatSRf <- labelled::labelled(Mali_ea_2022$FCSFatSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2022$FCSFatSRf)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,FCSFatSRf,show.na = T)


#Base Mali_pdm_2022
# Pour les sources, il n'y a que des NA
expss::val_lab(Mali_pdm_2022$FCSFatSRf)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSFatSRf,show.na = T)

```



### FSC : Sucre ou sucreries, tels que (sucre, miel, confiture, gâteau, bonbons, biscuits, viennoiserie et autres produits sucrés (boissons sucrées)  )

```{r FCSSugar}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugar,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugar,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugar,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugar,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugar,show.na = T)
```

### FSC : Sucre ou sucreries, tels que (sucre, miel, confiture, gâteau, bonbons, biscuits, viennoiserie et autres produits sucrés (boissons sucrées)  ) - Sources

```{r FCSSugar Sources}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$FCSSugarSRf)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate_at(c("FCSSugarSRf"),recode,"1"=1,"2"=1,"3"=1,"4"=5,"5"=10,"6"=10,"7"=9,"8"=6,"9"=2,"10"=8)

Mali_baseline_2018$FCSSugarSRf <- labelled::labelled(Mali_baseline_2018$FCSSugarSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette= 3,`Prêts`=4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))

expss::val_lab(Mali_baseline_2018$FCSSugarSRf)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$FCSSugarSRf)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)

Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate_at(c("FCSSugarSRf"),recode,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=6,"7"=7,"8"=8,"9"=9,"10"=10)

Mali_ea_2020$FCSSugarSRf <- labelled::labelled(Mali_ea_2020$FCSSugarSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2020$FCSSugarSRf)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$FCSSugarSRf)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)

Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("FCSSugarSRf"),recode,"100"=1,"200"=2,"300"=3,"400"=4,"500"=5,"600"=6,"700"=7,"800"=8,"900"=9,"1000"=10)

Mali_ea_2021$FCSSugarSRf <- labelled::labelled(Mali_ea_2021$FCSSugarSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2021$FCSSugarSRf)
Mali_ea_2021 %>%
  plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$FCSSugarSRf)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("FCSSugarSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_ea_2022$FCSSugarSRf <- labelled::labelled(Mali_ea_2022$FCSSugarSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2022$FCSSugarSRf)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$FCSSugarSRf)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)

Mali_pdm_2022 <- 
  Mali_pdm_2022 %>% dplyr::mutate_at(c("FCSSugarSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_pdm_2022$FCSSugarSRf <- labelled::labelled(Mali_pdm_2022$FCSSugarSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_pdm_2022$FCSSugarSRf)
Mali_pdm_2022 %>%
  plot_frq(coord.flip =T,FCSSugarSRf,show.na = T)
```



### FCS : Condiments/épices: tels que (thé, café/cacao, sel, ail, épices, levure/levure chimique, tomate/sauce, viande ou poisson comme condiment, condiments incluant des petites quantités de lait/thé, café.) ?

```{r FCSCond}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCond,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,FCSCond,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,FCSCond,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSCond,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,FCSCond,show.na = T)
```

### FCS : Condiments/épices: tels que (thé, café/cacao, sel, ail, épices, levure/levure chimique, tomate/sauce, viande ou poisson comme condiment, condiments incluant des petites quantités de lait/thé, café.) ? - Sources

```{r FCSCond Sources}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$FCSCondSRf)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCondSRf,show.na = T)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate_at(c("FCSCondSRf"),recode,"1"=1,"2"=1,"3"=1,"4"=5,"5"=10,"6"=10,"7"=9,"8"=6,"9"=2,"10"=8)

Mali_baseline_2018$FCSCondSRf <- labelled::labelled(Mali_baseline_2018$FCSCondSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette= 3,`Prêts`=4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))

expss::val_lab(Mali_baseline_2018$FCSCondSRf)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,FCSCondSRf,show.na = T)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$FCSCondSRf)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCondSRf,show.na = T)

Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate_at(c("FCSCondSRf"),recode,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=6,"7"=7,"8"=8,"9"=9,"10"=10)

Mali_ea_2020$FCSCondSRf <- labelled::labelled(Mali_ea_2020$FCSCondSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2020$FCSCondSRf)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,FCSCondSRf,show.na = T)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$FCSCondSRf)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCondSRf,show.na = T)

Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("FCSCondSRf"),recode,"100"=1,"200"=2,"300"=3,"400"=4,"500"=5,"600"=6,"700"=7,"800"=8,"900"=9,"1000"=10)

Mali_ea_2021$FCSCondSRf <- labelled::labelled(Mali_ea_2021$FCSCondSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2021$FCSCondSRf)
Mali_ea_2021 %>%
  plot_frq(coord.flip =T,FCSCondSRf,show.na = T)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$FCSCondSRf)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCondSRf,show.na = T)

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("FCSCondSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_ea_2022$FCSCondSRf <- labelled::labelled(Mali_ea_2022$FCSCondSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_ea_2022$FCSCondSRf)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,FCSCondSRf,show.na = T)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$FCSCondSRf)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCondSRf,show.na = T)

Mali_pdm_2022 <- 
  Mali_pdm_2022 %>% dplyr::mutate_at(c("FCSCondSRf"),recode,"Production propre (récoltes, élevage)"=1,"Pêche / Chasse"=2,"Cueillette"=3,"Prêts"=4,"Marché (achat avec des espèces)"=5,"Marché (achat à crédit)"=6,"Mendicité"=7,"Troc travail ou biens contre des aliments"=8,"Dons (aliments) de membres de la famille ou d'amis"=9,"Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc."=10)

Mali_pdm_2022$FCSCondSRf <- labelled::labelled(Mali_pdm_2022$FCSCondSRf, c(`Production propre (récoltes, élevage)` = 1, `Pêche / Chasse` = 2, Cueillette = 3,`Prêts`= 4,`Marché (achat avec des espèces)`=5,`Marché (achat à crédit)`=6,`Mendicité`=7,`Troc travail ou biens contre des aliments`=8,`Dons (aliments) de membres de la famille ou d’amis`=9,`Aide alimentaire de la société civile, ONG, gouvernement, PAM, etc`=10))


expss::val_lab(Mali_pdm_2022$FCSCondSRf)
Mali_pdm_2022 %>%
  plot_frq(coord.flip =T,FCSCondSRf,show.na = T)

```


### FCS computation

```{r FCS}

#calculate FCS
Mali_baseline_2018 <- Mali_baseline_2018 %>% mutate(FCS = (2 * FCSStap) + (3 * FCSPulse)+ (4*FCSPr) +FCSVeg  +FCSFruit +(4*FCSDairy) + (0.5*FCSFat) + (0.5*FCSSugar))
var_label(Mali_baseline_2018$FCS) <- "Score de consommation alimentaire"
#create FCG groups based on 21/25 or 28/42 thresholds - analyst should decide which one to use.
Mali_baseline_2018 <- Mali_baseline_2018 %>% mutate(
  FCSCat21 = case_when(
    FCS <= 21 ~ "Pauvre", between(FCS, 21.5, 35) ~ "Limite", FCS > 35 ~ "Acceptable"),
  FCSCat28 = case_when(
    FCS <= 28 ~ "Pauvre", between(FCS, 28.5, 42) ~ "Limite", FCS > 42 ~ "Acceptable"))
var_label(Mali_baseline_2018$FCSCat21) <- "Groupe de consommation alimentaire - Seuils du 21/35"
var_label(Mali_baseline_2018$FCSCat28) <-  "Groupe de consommation alimentaire - Seuils du 28/42"

Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat21,show.na = T)
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat28,show.na = T)


#############################
#calculate FCS
Mali_ea_2020 <- Mali_ea_2020 %>% mutate(FCS = (2 * FCSStap) + (3 * FCSPulse)+ (4*FCSPr) +FCSVeg  +FCSFruit +(4*FCSDairy) + (0.5*FCSFat) + (0.5*FCSSugar))
var_label(Mali_ea_2020$FCS) <- "Score de consommation alimentaire"
#create FCG groups based on 21/25 or 28/42 thresholds - analyst should decide which one to use.
Mali_ea_2020 <- Mali_ea_2020 %>% mutate(
  FCSCat21 = case_when(
    FCS <= 21 ~ "Pauvre", between(FCS, 21.5, 35) ~ "Limite", FCS > 35 ~ "Acceptable"),
  FCSCat28 = case_when(
    FCS <= 28 ~ "Pauvre", between(FCS, 28.5, 42) ~ "Limite", FCS > 42 ~ "Acceptable"))
var_label(Mali_ea_2020$FCSCat21) <- "Groupe de consommation alimentaire - Seuils du 21/35"
var_label(Mali_ea_2020$FCSCat28) <-  "Groupe de consommation alimentaire - Seuils du 28/42"

Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat21,show.na = T)
Mali_ea_2020 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat28,show.na = T)

#######################################
#calculate FCS
Mali_ea_2021 <- Mali_ea_2021 %>% mutate(FCS = (2 * FCSStap) + (3 * FCSPulse)+ (4*FCSPr) +FCSVeg  +FCSFruit +(4*FCSDairy) + (0.5*FCSFat) + (0.5*FCSSugar))
var_label(Mali_ea_2021$FCS) <- "Score de consommation alimentaire"
#create FCG groups based on 21/25 or 28/42 thresholds - analyst should decide which one to use.
Mali_ea_2021 <- Mali_ea_2021 %>% mutate(
  FCSCat21 = case_when(
    FCS <= 21 ~ "Pauvre", between(FCS, 21.5, 35) ~ "Limite", FCS > 35 ~ "Acceptable"),
  FCSCat28 = case_when(
    FCS <= 28 ~ "Pauvre", between(FCS, 28.5, 42) ~ "Limite", FCS > 42 ~ "Acceptable"))
var_label(Mali_ea_2021$FCSCat21) <- "Groupe de consommation alimentaire - Seuils du 21/35"
var_label(Mali_ea_2021$FCSCat28) <-  "Groupe de consommation alimentaire - Seuils du 28/42"

Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat21,show.na = T)
Mali_ea_2021 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat28,show.na = T)

#############################################
#calculate FCS
Mali_ea_2022 <- Mali_ea_2022 %>% mutate(FCS = (2 * FCSStap) + (3 * FCSPulse)+ (4*FCSPr) +FCSVeg  +FCSFruit +(4*FCSDairy) + (0.5*FCSFat) + (0.5*FCSSugar))
var_label(Mali_ea_2022$FCS) <- "Score de consommation alimentaire"
#create FCG groups based on 21/25 or 28/42 thresholds - analyst should decide which one to use.
Mali_ea_2022 <- Mali_ea_2022 %>% mutate(
  FCSCat21 = case_when(
    FCS <= 21 ~ "Pauvre", between(FCS, 21.5, 35) ~ "Limite", FCS > 35 ~ "Acceptable"),
  FCSCat28 = case_when(
    FCS <= 28 ~ "Pauvre", between(FCS, 28.5, 42) ~ "Limite", FCS > 42 ~ "Acceptable"))
var_label(Mali_ea_2022$FCSCat21) <- "Groupe de consommation alimentaire - Seuils du 21/35"
var_label(Mali_ea_2022$FCSCat28) <-  "Groupe de consommation alimentaire - Seuils du 28/42"

Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat21,show.na = T)
Mali_ea_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat28,show.na = T)

########################################
#calculate FCS
Mali_pdm_2022 <- Mali_pdm_2022 %>% mutate(FCS = (2 * FCSStap) + (3 * FCSPulse)+ (4*FCSPr) +FCSVeg  +FCSFruit +(4*FCSDairy) + (0.5*FCSFat) + (0.5*FCSSugar))
var_label(Mali_pdm_2022$FCS) <- "Score de consommation alimentaire"
#create FCG groups based on 21/25 or 28/42 thresholds - analyst should decide which one to use.
Mali_pdm_2022 <- Mali_pdm_2022 %>% mutate(
  FCSCat21 = case_when(
    FCS <= 21 ~ "Pauvre", between(FCS, 21.5, 35) ~ "Limite", FCS > 35 ~ "Acceptable"),
  FCSCat28 = case_when(
    FCS <= 28 ~ "Pauvre", between(FCS, 28.5, 42) ~ "Limite", FCS > 42 ~ "Acceptable"))
var_label(Mali_pdm_2022$FCSCat21) <- "Groupe de consommation alimentaire - Seuils du 21/35"
var_label(Mali_pdm_2022$FCSCat28) <-  "Groupe de consommation alimentaire - Seuils du 28/42"

Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat21,show.na = T)
Mali_pdm_2022 %>% 
  sjPlot::plot_frq(coord.flip =T,FCSCat28,show.na = T)

```



## reduced coping strategy index OU l’indice réduit des stratégies de survie (rCSI)

### rCSI : Consommer des aliments moins préférés et moins chers

```{r rCSILessQlty}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,rCSILessQlty,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,rCSILessQlty,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,rCSILessQlty,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSILessQlty,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSILessQlty,show.na = T)
```


### rCSI : Emprunter de la nourriture ou compter sur l’aide des parents/amis


```{r rCSIBorrow}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,rCSIBorrow,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIBorrow,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIBorrow,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIBorrow,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIBorrow,show.na = T)
```



### rCSI : Diminuer la quantité consommée pendant les repas

```{r rCSIMealSize}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealSize,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealSize,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealSize,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealSize,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealSize,show.na = T)
```


### rCSI :  Restreindre la consommation des adultes  pour nourrir les enfants

```{r rCSIMealAdult}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealAdult,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealAdult,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealAdult,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealAdult,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealAdult,show.na = T)
```


### rCSI : Diminuer le nombre de repas par jour

```{r rCSIMealNb}
Mali_baseline_2018 %>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealNb,show.na = T)

Mali_ea_2020%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealNb,show.na = T)

Mali_ea_2021%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealNb,show.na = T)

Mali_ea_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealNb,show.na = T)

Mali_pdm_2022%>% 
  sjPlot::plot_frq(coord.flip =T,rCSIMealNb,show.na = T)
```


```{r rCSI Score}
#calculate rCSI Score
Mali_baseline_2018 <- Mali_baseline_2018 %>% mutate(rCSI = rCSILessQlty  + (2 * rCSIBorrow) + rCSIMealSize + (3 * rCSIMealAdult) + rCSIMealNb)
var_label(Mali_baseline_2018$rCSI) <- "rCSI"

#calculate rCSI Score
Mali_ea_2020 <- Mali_ea_2020 %>% mutate(rCSI = rCSILessQlty  + (2 * rCSIBorrow) + rCSIMealSize + (3 * rCSIMealAdult) + rCSIMealNb)
var_label(Mali_ea_2020$rCSI) <- "rCSI"

#calculate rCSI Score
Mali_ea_2021 <- Mali_ea_2021 %>% mutate(rCSI = rCSILessQlty  + (2 * rCSIBorrow) + rCSIMealSize + (3 * rCSIMealAdult) + rCSIMealNb)
var_label(Mali_ea_2021$rCSI) <- "rCSI"

#calculate rCSI Score
Mali_ea_2022 <- Mali_ea_2022 %>% mutate(rCSI = rCSILessQlty  + (2 * rCSIBorrow) + rCSIMealSize + (3 * rCSIMealAdult) + rCSIMealNb)
var_label(Mali_ea_2022$rCSI) <- "rCSI"

#calculate rCSI Score
Mali_pdm_2022 <- Mali_pdm_2022 %>% mutate(rCSI = rCSILessQlty  + (2 * rCSIBorrow) + rCSIMealSize + (3 * rCSIMealAdult) + rCSIMealNb)
var_label(Mali_pdm_2022$rCSI) <- "rCSI"

```


## Stratégies d'adaptation aux moyens d'existence (LhCSI)

```{r LhCSI labels values}
# 1 = Non, je n'ai pas été confronté à une insuffisance de nourriture
# 2 = Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire
# 3 = Oui
# 4 = Non applicable

```


### LhCSI : Vendre des actifs/biens non productifs du ménage (radio, meuble, réfrigérateur, télévision, bijoux etc.)

```{r LhCSIStress1}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$LhCSIStress1)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(LhCSIStress1 = dplyr::recode(LhCSIStress1,"0"=1,"1"=2,"2"=3,"3"=4))
Mali_baseline_2018$LhCSIStress1 <- labelled::labelled(Mali_baseline_2018$LhCSIStress1, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_baseline_2018$LhCSIStress1)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$LhCSIStress1)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)

Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(LhCSIStress1 = dplyr::recode(LhCSIStress1,"1"=1,"2"=2,"3"=3,"999"=4))
Mali_ea_2020$LhCSIStress1 <- labelled::labelled(Mali_ea_2020$LhCSIStress1, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2020$LhCSIStress1)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$LhCSIStress1)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)

Mali_ea_2021 <- Mali_ea_2021 %>% 
  dplyr::mutate(LhCSIStress1 = dplyr::recode(LhCSIStress1,"1"=1,"2"=2,"3"=3,"4"=4))
Mali_ea_2021$LhCSIStress1 <- labelled::labelled(Mali_ea_2021$LhCSIStress1, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSIStress1)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$LhCSIStress1)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)

Mali_ea_2022 <- Mali_ea_2022 %>% 
  dplyr::mutate(LhCSIStress1 = dplyr::recode(LhCSIStress1,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Oui"=3,"Non applicable"=4))
Mali_ea_2022$LhCSIStress1 <- labelled::labelled(as.numeric(as.character(Mali_ea_2022$LhCSIStress1)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2022$LhCSIStress1)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$LhCSIStress1)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)

Mali_pdm_2022 <- Mali_pdm_2022 %>%
  dplyr::mutate(LhCSIStress1 = dplyr::recode(LhCSIStress1,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Oui"=3,"Non applicable"=4))
Mali_pdm_2022$LhCSIStress1 <- labelled::labelled(as.numeric(as.character(Mali_pdm_2022$LhCSIStress1)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_pdm_2022$LhCSIStress1)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress1)
```


```{r LhCSIStress2}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$LhCSIStress2)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIStress2)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(LhCSIStress2 = dplyr::recode(LhCSIStress2,"0"=1,"1"=2,"2"=3,"3"=4))
Mali_baseline_2018$LhCSIStress2 <- labelled::labelled(Mali_baseline_2018$LhCSIStress2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_baseline_2018$LhCSIStress2)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIStress2)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$LhCSIStress2)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIStress2)

Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(LhCSIStress2 = dplyr::recode(LhCSIStress2,"3"=3,"2"=2,"1"=1,"999"=4))
Mali_ea_2020$LhCSIStress2 <- labelled::labelled(Mali_ea_2020$LhCSIStress2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2020$LhCSIStress2)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIStress2)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$LhCSIStress2)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIStress2)

Mali_ea_2021$LhCSIStress2 <- labelled::labelled(Mali_ea_2021$LhCSIStress2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSIStress2)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIStress2)

#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$LhCSIStress2)
Mali_ea_2022 %>%
  plot_frq(coord.flip =T,LhCSIStress2)

Mali_ea_2022 <- Mali_ea_2022 %>% 
  dplyr::mutate(LhCSIStress2 = dplyr::recode(LhCSIStress2,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_ea_2022$LhCSIStress2 <- labelled::labelled(Mali_ea_2022$LhCSIStress2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2022$LhCSIStress2)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress2)

#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$LhCSIStress2)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress2)

Mali_pdm_2022 <- Mali_pdm_2022 %>% 
  dplyr::mutate(LhCSIStress2 = dplyr::recode(LhCSIStress2,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_pdm_2022$LhCSIStress2 <- labelled::labelled(Mali_pdm_2022$LhCSIStress2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_pdm_2022$LhCSIStress2)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress2)
```


### LhCSI : Dépenser l’épargne en raison d'un manque de nourriture ou d'argent pour acheter de la nourriture ?

```{r LhCSIStress3}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$LhCSIStress3)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIStress3)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(LhCSIStress3 = dplyr::recode(LhCSIStress3,"2"=3,"1"=2,"0"=1,"3"=4))
Mali_baseline_2018$LhCSIStress3 <- labelled::labelled(Mali_baseline_2018$LhCSIStress3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_baseline_2018$LhCSIStress3)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIStress3)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$LhCSIStress3)
Mali_ea_2020 %>%
  plot_frq(coord.flip =T,LhCSIStress3)

Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(LhCSIStress3 = dplyr::recode(LhCSIStress3,"1"=1,"3"=3,"2"=2,"999"=4))
Mali_ea_2020$LhCSIStress3 <- labelled::labelled(Mali_ea_2020$LhCSIStress3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2020$LhCSIStress3)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIStress3)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$LhCSIStress3)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIStress3)

Mali_ea_2021$LhCSIStress3 <- labelled::labelled(Mali_ea_2021$LhCSIStress3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSIStress3)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIStress3)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$LhCSIStress3)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress3)

Mali_ea_2022 <- Mali_ea_2022 %>%
  dplyr::mutate(LhCSIStress3 = dplyr::recode(LhCSIStress3,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_ea_2022$LhCSIStress3 <- labelled::labelled(Mali_ea_2022$LhCSIStress3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2022$LhCSIStress3)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress3)


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$LhCSIStress3)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress3)

Mali_pdm_2022 <- Mali_pdm_2022 %>%
  dplyr::mutate(LhCSIStress3 = dplyr::recode(LhCSIStress3,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_pdm_2022$LhCSIStress3 <- labelled::labelled(Mali_pdm_2022$LhCSIStress3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_pdm_2022$LhCSIStress3)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress3)
```


### LhCSI : Emprunter de l’argent / nourriture auprès d’un prêteur formel /banque

```{r LhCSIStress4,error=TRUE}
#Base Mali_baseline_2018
# Il n'y a que des NA


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$LhCSIStress4)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIStress4)

Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(LhCSIStress4 = dplyr::recode(LhCSIStress4,"3"=3,"2"=2,"1"=1,"999"=4))
Mali_ea_2020$LhCSIStress4 <- labelled::labelled(Mali_ea_2020$LhCSIStress4, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2020$LhCSIStress4)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIStress4)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$LhCSIStress4)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIStress4)

Mali_ea_2021$LhCSIStress4 <- labelled::labelled(Mali_ea_2021$LhCSIStress4, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSIStress4)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIStress4)


#Base Mali_ea_2022

Mali_ea_2022 %>% dplyr::mutate_at(c("LhCSIStress4"),recode,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4)
Mali_ea_2022$LhCSIStress4 <- labelled::labelled(as.numeric(as.character(Mali_ea_2022$LhCSIStress4)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$LhCSIStress4)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIStress4)

Mali_pdm_2022 %>% dplyr::mutate_at(c("LhCSIStress4"),recode,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4)
Mali_pdm_2022$LhCSIStress4 <- labelled::labelled(as.numeric(as.character(Mali_pdm_2022$LhCSIStress4)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))


```


### LhCSI : Réduire les dépenses non alimentaires essentielles telles que l’éducation, la santé (dont de médicaments)

```{r LhCSICrisis1}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$LhCSICrisis1)
Mali_baseline_2018 %>%
  plot_frq(coord.flip =T,LhCSICrisis1)
Mali_baseline_2018$LhCSICrisis1 <- as.character(Mali_baseline_2018$LhCSICrisis1)

Mali_baseline_2018 <-
  Mali_baseline_2018 %>% dplyr::mutate(LhCSICrisis1 = dplyr::recode(LhCSICrisis1,"2"=3,"1"=2,"0"=1,"3"=4))
Mali_baseline_2018$LhCSICrisis1 <- labelled::labelled(Mali_baseline_2018$LhCSICrisis1, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_baseline_2018$LhCSICrisis1)
Mali_baseline_2018 %>%
  plot_frq(coord.flip =T,LhCSICrisis1)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$LhCSICrisis1)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSICrisis1)

Mali_ea_2020 %>% dplyr::mutate(LhCSICrisis1 = dplyr::recode(LhCSICrisis1,"3"=3,"2"=2,"1"=1,"999"=4))
Mali_ea_2020$LhCSICrisis1 <- labelled::labelled(Mali_ea_2020$LhCSICrisis1, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2020$LhCSICrisis1)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSICrisis1)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$LhCSICrisis1)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSICrisis1)

Mali_ea_2021$LhCSICrisis1 <- labelled::labelled(Mali_ea_2021$LhCSICrisis1, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSICrisis1)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSICrisis1)


#Base Mali_ea_2022

Mali_ea_2022 %>% dplyr::mutate(LhCSICrisis1 = dplyr::recode(LhCSICrisis1,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_ea_2022$LhCSICrisis1 <- labelled::labelled(as.numeric(as.character(Mali_ea_2022$LhCSICrisis1)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))



#Base Mali_pdm_2022
Mali_pdm_2022 %>% dplyr::mutate(LhCSICrisis1 = dplyr::recode(LhCSICrisis1,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_pdm_2022$LhCSICrisis1 <- labelled::labelled(as.numeric(as.character(Mali_pdm_2022$LhCSICrisis1)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))
```


### LhCSI : Vendre des biens productifs ou des moyens de transport (machine à coudre, brouette, vélo, car, etc.)

```{r LhCSICrisis2}
#View labels
expss::val_lab(Mali_baseline_2018$LhCSICrisis2)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSICrisis2)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(LhCSICrisis2 = dplyr::recode(LhCSICrisis2,"2"=3,"1"=2,"0"=1,"3"=4))
Mali_baseline_2018$LhCSICrisis2 <- labelled::labelled(Mali_baseline_2018$LhCSICrisis2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_baseline_2018$LhCSICrisis2)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSICrisis2)



#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$LhCSICrisis2)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSICrisis2)

Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(LhCSICrisis2 = dplyr::recode(LhCSICrisis2,"3"=3,"2"=2,"1"=1,"999"=4))
Mali_ea_2020$LhCSICrisis2 <- labelled::labelled(Mali_ea_2020$LhCSICrisis2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2020$LhCSICrisis2)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSICrisis2)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$LhCSICrisis2)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSICrisis2)

Mali_ea_2021$LhCSICrisis2 <- labelled::labelled(Mali_ea_2021$LhCSICrisis2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSICrisis2)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSICrisis2)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$LhCSICrisis2)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSICrisis2)

Mali_ea_2022 %>% dplyr::mutate(LhCSICrisis2 = dplyr::recode(LhCSICrisis2,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_ea_2022$LhCSICrisis2 <- labelled::labelled(as.numeric(as.character(Mali_ea_2022$LhCSICrisis2)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$LhCSICrisis2)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSICrisis2)

Mali_pdm_2022 %>% dplyr::mutate(LhCSICrisis2 = dplyr::recode(LhCSICrisis2,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_pdm_2022$LhCSICrisis2 <- labelled::labelled(as.numeric(as.character(Mali_pdm_2022$LhCSICrisis2)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))
```

### LhCSI : Retirer les enfants de l’école

```{r LhCSICrisis3}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$LhCSICrisis3)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSICrisis3)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(LhCSICrisis3 = dplyr::recode(LhCSICrisis3,"2"=3,"1"=2,"0"=1,"3"=4))
Mali_baseline_2018$LhCSICrisis3 <- labelled::labelled(Mali_baseline_2018$LhCSICrisis3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_baseline_2018$LhCSICrisis3)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSICrisis3)


#Base Mali_ea_2020 
expss::val_lab(Mali_ea_2020$LhCSICrisis3)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSICrisis3)

Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(LhCSICrisis3 = dplyr::recode(LhCSICrisis3,"3"=3,"2"=2,"1"=1,"999"=4))
Mali_ea_2020$LhCSICrisis3 <- labelled::labelled(Mali_ea_2020$LhCSICrisis3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2020$LhCSICrisis3)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSICrisis3)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$LhCSICrisis3)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSICrisis3)

Mali_ea_2021$LhCSICrisis3 <- labelled::labelled(Mali_ea_2021$LhCSICrisis3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSICrisis3)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSICrisis3)

#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$LhCSICrisis3)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSICrisis3)

Mali_ea_2022 %>% dplyr::mutate(LhCSICrisis3 = dplyr::recode(LhCSICrisis3,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_ea_2022$LhCSICrisis3 <- labelled::labelled(as.numeric(as.character(Mali_ea_2022$LhCSICrisis3)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))



#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$LhCSICrisis3)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSICrisis3)

Mali_pdm_2022 %>% dplyr::mutate(LhCSICrisis3 = dplyr::recode(LhCSICrisis3,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_pdm_2022$LhCSICrisis3 <- labelled::labelled(as.numeric(as.character(Mali_pdm_2022$LhCSICrisis3)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

```


```{r LhCSIEmergency1}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$LhCSIEmergency1)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency1)
Mali_baseline_2018$LhCSIEmergency1 <- as.character(Mali_baseline_2018$LhCSIEmergency1)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(LhCSIEmergency1 = dplyr::recode(LhCSIEmergency1,"2"=3,"1"=2,"0"=1,"3"=4))
Mali_baseline_2018$LhCSIEmergency1 <- labelled::labelled(Mali_baseline_2018$LhCSIEmergency1, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_baseline_2018$LhCSIEmergency1)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency1)


#Base Mali_ea_2020
# Il n'y a que des NA

#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$LhCSIEmergency1)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency1)

Mali_ea_2021$LhCSIEmergency1 <- labelled::labelled(Mali_ea_2021$LhCSIEmergency1, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSIEmergency1)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency1)


expss::val_lab(Mali_ea_2022$LhCSIEmergency1)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency1)

#Base Mali_ea_2022
Mali_ea_2022 %>% dplyr::mutate(LhCSIEmergency1 = dplyr::recode(LhCSIEmergency1,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_ea_2022$LhCSIEmergency1 <- labelled::labelled(as.numeric(as.character(Mali_ea_2022$LhCSIEmergency1)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$LhCSIEmergency1)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency1)

Mali_pdm_2022 %>% dplyr::mutate(LhCSIEmergency1 = dplyr::recode(LhCSIEmergency1,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_pdm_2022$LhCSIEmergency1 <- labelled::labelled(as.numeric(as.character(Mali_pdm_2022$LhCSIEmergency1)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))
```


### LhCSI : Mendier

```{r LhCSIEmergency2}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$LhCSIEmergency2)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency2)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(LhCSIEmergency2 = dplyr::recode(LhCSIEmergency2,"2"=3,"1"=2,"0"=1,"3"=4))
Mali_baseline_2018$LhCSIEmergency2 <- labelled::labelled(Mali_baseline_2018$LhCSIEmergency2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_baseline_2018$LhCSIEmergency2)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency2)

#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$LhCSIEmergency2)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency2)

Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(LhCSIEmergency2 = dplyr::recode(LhCSIEmergency2,"3"=3,"2"=2,"1"=1,"999"=4))
Mali_ea_2020$LhCSIEmergency2 <- labelled::labelled(Mali_ea_2020$LhCSIEmergency2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2020$LhCSIEmergency2)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency2)

#Base Mali_ea_2021 
expss::val_lab(Mali_ea_2021$LhCSIEmergency2)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency2)

Mali_ea_2021$LhCSIEmergency2 <- labelled::labelled(Mali_ea_2021$LhCSIEmergency2, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSIEmergency2)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency2)

#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$LhCSIEmergency2)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency2)

Mali_ea_2022 %>% dplyr::mutate(LhCSIEmergency2 = dplyr::recode(LhCSIEmergency2,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_ea_2022$LhCSIEmergency2 <- labelled::labelled(as.numeric(as.character(Mali_ea_2022$LhCSIEmergency2)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$LhCSIEmergency2)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency2)

Mali_pdm_2022 %>% dplyr::mutate(LhCSIEmergency2 = dplyr::recode(LhCSIEmergency2,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_pdm_2022$LhCSIEmergency2 <- labelled::labelled(as.numeric(as.character(Mali_pdm_2022$LhCSIEmergency2)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))
```


### LhCSI : Vendre les derniers animaux femelles reproductrices

```{r LhCSIEmergency3}
#Base Mali_baseline_2018
expss::val_lab(Mali_baseline_2018$LhCSIEmergency3)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency3)

Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(LhCSIEmergency3 = dplyr::recode(LhCSIEmergency3,"2"=3,"1"=2,"0"=1,"3"=4))
Mali_baseline_2018$LhCSIEmergency3 <- labelled::labelled(Mali_baseline_2018$LhCSIEmergency3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j’ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_baseline_2018$LhCSIEmergency3)
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency3)


#Base Mali_ea_2020
expss::val_lab(Mali_ea_2020$LhCSIEmergency3)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency3)

Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(LhCSIEmergency3 = dplyr::recode(LhCSIEmergency3,"3"=3,"2"=2,"1"=1,"999"=4))
Mali_ea_2020$LhCSIEmergency3 <- labelled::labelled(Mali_ea_2020$LhCSIEmergency3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2020$LhCSIEmergency3)
Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency3)


#Base Mali_ea_2021
expss::val_lab(Mali_ea_2021$LhCSIEmergency3)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency3)

Mali_ea_2021$LhCSIEmergency3 <- labelled::labelled(Mali_ea_2021$LhCSIEmergency3, c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))

expss::val_lab(Mali_ea_2021$LhCSIEmergency3)
Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency3)


#Base Mali_ea_2022
expss::val_lab(Mali_ea_2022$LhCSIEmergency3)
Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency3)

Mali_ea_2022 %>% dplyr::mutate(LhCSIEmergency3 = dplyr::recode(LhCSIEmergency3,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_ea_2022$LhCSIEmergency3 <- labelled::labelled(as.numeric(as.character(Mali_ea_2022$LhCSIEmergency3)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))


#Base Mali_pdm_2022
expss::val_lab(Mali_pdm_2022$LhCSIEmergency3)
Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,LhCSIEmergency3)

Mali_pdm_2022 %>% dplyr::mutate(LhCSIEmergency3 = dplyr::recode(LhCSIEmergency3,"Oui"=3,"Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire"=2,"Non, je n'ai pas été confronté à une insuffisance de nourriture"=1,"Non applicable"=4))
Mali_pdm_2022$LhCSIEmergency3 <- labelled::labelled(as.numeric(as.character(Mali_pdm_2022$LhCSIEmergency3)), c(`Non, je n'ai pas été confronté à une insuffisance de nourriture` = 1, `Non, parce que j'ai déjà vendu ces actifs ou mené cette activité au cours des 12 derniers mois et je ne peux pas continuer à le faire` = 2, Oui= 3,`Non applicable`=4))
```

# Self-evaluated resilience score (SERS) 

```{r}
expss::val_lab(Mali_ea_2021$SERSFamAmis)
table(Mali_ea_2021$SERSFamAmis)
table(Mali_ea_2022$SERSFamAmis)
```


Il n'y a pas les variables SERS dans Mali_baseline, Mali_ea_2020

```{r}
#MON AJOUT
unique(Mali_baseline_2018$SERSRebondir) # NA
unique(Mali_ea_2020$SERSRebondir) # NA
unique(Mali_ea_2021$SERSRebondir) # recoder
unique(Mali_ea_2021$SERSLecons) # recoder
unique(Mali_ea_2022$SERSRebondir) # Non recoder
unique(Mali_pdm_2022$SERSRebondir)# Non recoder
```


```{r SERS_OK eval=FALSE}
sers_variables = Mali_baseline_2018 %>% dplyr::select(gtsummary::starts_with("SERS")) %>% names()

#M_SERS_2018=Mali_baseline_2018 %>% dplyr::select(gtsummary::starts_with("SERS"))

#all(sapply(M_SERS_2018, function(col) all(is.na(col))))
#TRUE
#Toutes les variables SERS sont vides dans Mali_baseline_2018

expss::val_lab(Mali_ea_2020$SERSRebondir)
#NULL

#M_SERS_2020=Mali_ea_2020 %>% dplyr::select(gtsummary::starts_with("SERS"))

#all(sapply(M_SERS_2020, function(col) all(is.na(col))))
#Toutes les variables SERS sont vides dans Mali_ea_2020



expss::val_lab(Mali_ea_2021$SERSRebondir)
#labeliser


expss::val_lab(Mali_ea_2022$SERSRebondir)
#NULL

Mali_ea_2022 <- Mali_ea_2022 %>% 
  dplyr::mutate(across(sers_variables,
                ~dplyr::recode(.,
                  "Tout à fait d'accord," = 1,
                  "D'accord," = 2,
                  "Ni d'accord ni pas d'accord" = 3,
                  "Pas d'accord," = 4,
                  "Pas du tout d'accord" = 5
                )))


Mali_ea_2022 <- Mali_ea_2022 %>% 
  dplyr::mutate(across(sers_variables,
                ~haven::labelled(., labels = c(
                  "tout à fait d'accord" = 1,
                  "d'accord" = 2,
                  "ni d'accord ni pas d'accord " = 3,
                  "pas d'accord" = 4,
                  "pas du tout d'accord" = 5
                ))))

Mali_ea_2022 <- Mali_ea_2022 %>%
 mutate(across(sers_variables, as.factor))


expss::val_lab(Mali_pdm_2022$SERSRebondir)
#NULL


Mali_pdm_2022 <- Mali_pdm_2022 %>% 
  dplyr::mutate(across(sers_variables,
                ~dplyr::recode(.,
                  "Tout à fait d'accord," = 1,
                  "D'accord," = 2,
                  "Ni d'accord ni pas d'accord" = 3,
                  "Pas d'accord," = 4,
                  "Pas du tout d'accord" = 5
                )))

Mali_pdm_2022 <- Mali_pdm_2022 %>% 
  dplyr::mutate(across(sers_variables,
                ~haven::labelled(., labels = c(
                  "tout à fait d'accord" = 1,
                  "d'accord" = 2,
                  "ni d'accord ni pas d'accord " = 3,
                  "pas d'accord" = 4,
                  "pas du tout d'accord" = 5
                )
                )
  )
  )

expss::val_lab(Mali_pdm_2022$SERSRebondir)


Mali_pdm_2022 <- Mali_pdm_2022 %>%
  mutate(across(sers_variables, as.factor))


```


# ASSET BENEFIT INDICATOR (ABI) 

```{r}
expss::val_lab(Mali_ea_2020$ABIProteger)
unique(Mali_baseline_2018$ABIProteger)
table(Mali_baseline_2018$ABIProteger)
```


```{r Valeur des ABI}

#Mon ajout
unique(Mali_baseline_2018$ABIProteger)
#0, 1, 2, NA
table(Mali_baseline_2018$ABIProteger)

unique(Mali_ea_2020$ABIProteger)
# 0, 1, 88, NA
table(Mali_ea_2020$ABIProteger)


unique(Mali_ea_2021$ABIProteger)
# 1,888, NA, 0
unique(Mali_ea_2022$ABIProteger)
#"Oui"         "Non"         "Ne sait pas"

unique(Mali_pdm_2022$ABIProteger)
#"Oui"         "Ne sait pas" "Non" 

expss::val_lab(Mali_baseline_2018$ABIProteger)
#Non Oui N/A 
# 0   1   2 
expss::val_lab(Mali_ea_2020$ABIProteger)
#NULL
expss::val_lab(Mali_ea_2021$ABIProteger)
#Non  Oui Ne sait pas 
#0    1         888 
expss::val_lab(Mali_ea_2022$ABIProteger)
#NULL
expss::val_lab(Mali_pdm_2022$ABIProteger)
#NULL
```


```{r}
# 0=Non ; 1=Oui ; 888=Ne sait pas ;
```



```{r MON AJOUT}
#MON AJOUT
abi_variables = Mali_baseline_2018 %>% dplyr::select(gtsummary::starts_with("ABI")) %>% names()
abi_variables <- c(abi_variables,"ActifCreationEmploi",
"BeneficieEmploi",
"TRavailMaintienActif")
#
abi_variables <- abi_variables[! abi_variables %in% c('ABISexparticipant')]


expss::val_lab(Mali_baseline_2018$ABIProteger)
#0, 1, 2, NA
Mali_baseline_2018 <- Mali_baseline_2018 %>% 
  dplyr::mutate(across(abi_variables,
                ~recode(.,
                  "0" = 0,
                  "1" = 1,
                  "NA" = 888,
                  "2"=888
                 )))

Mali_baseline_2018 <- Mali_baseline_2018 %>% 
  dplyr::mutate(across(abi_variables,
                ~labelled(., labels = c(
                  "Non" = 0,
                  "Oui" = 1,
                  "Ne sait pas" = 888
                )
                )))

#####

expss::val_lab(Mali_baseline_2018 $ABIProteger)

# 0, 1, 88, NA
Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(across(abi_variables,
                ~recode(.,
                  "0" = 0,
                  "1" = 1,
                  "88" = 888,
                  "NA" = 888 )))

Mali_ea_2020 <- Mali_ea_2020 %>% 
  dplyr::mutate(across(abi_variables,
                ~labelled(., labels = c(
                  "Non" = 0,
                  "Oui" = 1,
                  "Ne sait pas" = 888
                )
                )
  )
  )
expss::val_lab(Mali_ea_2020$ABIProteger)
#####


expss::val_lab(Mali_ea_2021$ABIProteger)
# 1,888, NA, 0
Mali_ea_2021 <- Mali_ea_2021 %>% 
  dplyr::mutate(across(abi_variables,
                ~recode(.,
                  "0" = 0,
                  "1" = 1,
                  "NA" = 888,
                  "888"=888
                 )
  )
  )
Mali_ea_2021 <- Mali_ea_2021 %>% 
  dplyr::mutate(across(abi_variables,
                ~labelled(., labels = c(
                  "Non" = 0,
                  "Oui" = 1,
                  "Ne sait pas" = 888
                )
                )
  )
  )
expss::val_lab(Mali_ea_2021$ABIProteger)
####


expss::val_lab(Mali_ea_2022$ABIProteger)
#NULL

Mali_ea_2022 <- Mali_ea_2022 %>% 
  dplyr::mutate(across(abi_variables,
                ~recode(.,
                  "Non" = 0,
                  "Oui" = 1,
                  "Ne sait pas" = 888
                 )
  )
  )

Mali_ea_2022 <- Mali_ea_2022 %>% 
  dplyr::mutate(across(abi_variables,
                ~labelled(., labels = c(
                  "Non" = 0,
                  "Oui" = 1,
                  "Ne sait pas" = 888
                )
                )
  )
  )
expss::val_lab(Mali_ea_2022$ABIProteger)
#######



expss::val_lab(Mali_pdm_2022$ABIProteger)
#NULL

Mali_pdm_2022 <- Mali_pdm_2022 %>% 
  dplyr::mutate(across(abi_variables,
                ~recode(.,
                  "Non" = 0,
                  "Oui" = 1,
                  "Ne sait pas" = 888
                 )
  )
  )


Mali_pdm_2022 <- Mali_pdm_2022 %>% 
  dplyr::mutate(across(abi_variables,
                ~labelled(., labels = c(
                  "Non" = 0,
                  "Oui" = 1,
                  "Ne sait pas" = 888
                )
                )
  )
  )

expss::val_lab(Mali_pdm_2022$ABIProteger)
```


# DEPART EN EXODE ET MIGRATION  

```{r eval=FALSE, include=FALSE}
mig_variables = c("MigrationEmploi",
"NbMigrants",
"RaisonMigration",
"AutreRaisonEconomiques",
"RaisonAccesServices",
"DestinationMigration",
"DureeMigration",
"TendanceMigration",
"RaisonHausseMig",
"RaisonBaisseMig"
)
```


# Social capital index (Indice de capital social)


```{r eval=FALSE, include=FALSE}
sci_variables = Mali_baseline_2018 %>% dplyr::select(gtsummary::starts_with("SCI")) %>% names()


```

# DIVERSITE ALIMENTAIRE DES FEMMES 

```{r eval=FALSE, include=FALSE}
mddw_variables = c("MDDW_resp_age",Mali_baseline_2018 %>% dplyr::select(gtsummary::starts_with("PWMDD")) %>% names())

```

# Régime alimentaire minimum acceptable (MAD)

```{r eval=FALSE, include=FALSE}
mad_variables = c("MAD_sex ",
"MAD_dob",
"MAD_resp_age ",
"EverBreastF",
"PCIYCBreastF",
"PCIYCInfFormNb",
"PCIYCDairyMiNb",
"PCIYCDairyYoNb",
"PCIYCStapPoNb",
"MAD_module",
"PCMADStapCer",
"PCMADVegOrg",
"PCMADStapRoo",
"PCMADVegGre",
"PCMADFruitOrg",
"PCMADVegFruitOth",
"PCMADPrMeatO",
"PCMADPrMeatF",
"PCMADPrEgg",
"PCMADPrFish",
"PCMADPulse",
"PCMADDairy",
"PCMADFatRpalm",
"PCMADSnfChild",
"PCMADSnfPowd",
"PCMADSnfLns",
"PCIYCMeals"
)
```

# Date format check

```{r Date format check}
Mali_baseline_2018$SvyDatePDM<-as.Date(Mali_baseline_2018$SvyDatePDM, origin = "1899-12-30" )

Mali_ea_2020$SvyDatePDM<-as.Date(Mali_ea_2020$SvyDatePDM, origin = "1899-12-30" )

Mali_ea_2021$SvyDatePDM<-as.Date(Mali_ea_2021$SvyDatePDM, origin = "1899-12-30" )

Mali_ea_2022$SvyDatePDM<-as.Date(Mali_ea_2022$SvyDatePDM, origin = "1899-12-30" )

Mali_pdm_2022$SvyDatePDM<-as.Date(Mali_pdm_2022$SvyDatePDM, origin = "1899-12-30" )

```


# Gender recodification

```{r Gender recodification}
# We need to recode gender label to:
# 0 = Femme
# 1 = Homme


#View labels
expss::val_lab(Mali_baseline_2018$HHHSex)

#Masculin  Féminin 
#   0        1 

Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,HHHSex)

Mali_baseline_2018$HHHSex<-dplyr::recode(Mali_baseline_2018$HHHSex, `1` = 0L, .default = 1L, .combine_value_labels = TRUE)


Mali_baseline_2018$HHHSex <- labelled::labelled(Mali_baseline_2018$HHHSex, c(Femme = 0, Homme = 1))


#Check new labels
expss::val_lab(Mali_baseline_2018$HHHSex) #OK
Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,HHHSex)



#View labels
expss::val_lab(Mali_ea_2020$HHHSex)

Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,HHHSex)


Mali_ea_2020$HHHSex<-dplyr::recode(Mali_ea_2020$HHHSex, "1" = 1, "0" = 0)

Mali_ea_2020$HHHSex <- labelled::labelled(Mali_ea_2020$HHHSex, c(Femme = 0, Homme = 1))

#Check labels
expss::val_lab(Mali_ea_2020$HHHSex) #OK

Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,HHHSex)




#View labels
expss::val_lab(Mali_ea_2021$HHHSex)

#Masculin  Féminin 
#   1        2 

Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,HHHSex)

Mali_ea_2021$HHHSex<-dplyr::recode(Mali_ea_2021$HHHSex, `2` = 0L, .default = 1L, .combine_value_labels = TRUE)

Mali_ea_2021$HHHSex <- labelled::labelled(Mali_ea_2021$HHHSex, c(Femme = 0, Homme = 1))

#Check new labels
expss::val_lab(Mali_ea_2021$HHHSex) #ok
Mali_ea_2021%>% 
  plot_frq(coord.flip =T,HHHSex)



#View labels
expss::val_lab(Mali_ea_2022$HHHSex)

#"Masculin" "Féminin"

Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,HHHSex)

Mali_ea_2022$HHHSex<-dplyr::recode(Mali_ea_2022$HHHSex, "Féminin" = 0, "Masculin"= 1)

#Mali_ea_2022$HHHSex<-as.numeric(Mali_ea_2022$HHHSex)

Mali_ea_2022$HHHSex <- labelled::labelled(Mali_ea_2022$HHHSex, c(Femme = 0, Homme = 1))


#Check labels
expss::val_lab(Mali_ea_2022$HHHSex)
# Femme Homme 
# 0      1

Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,HHHSex)



#View labels
expss::val_lab(Mali_pdm_2022$HHHSex)

#------------Mali_pdm_2022$HHHSex : la variable ne contient que des NA

#Mali_pdm_2022 %>% 
 # plot_frq(coord.flip =T,HHHSex)


```


```{r template, eval=FALSE, include=FALSE}
#expss::val_lab(Mali_baseline_2018$)
#expss::val_lab(Mali_ea_2020$)
#expss::val_lab(Mali_ea_2021$)
#expss::val_lab(Mali_ea_2022$)
#expss::val_lab(Mali_pdm_2022$)
```


# Household head education level

```{r Household head education level}
expss::val_lab(Mali_baseline_2018$HHHEdu)
#Label existe


Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(HHHEdu = dplyr::recode(HHHEdu,"0"=1,"1"=2, "2"=2,"3"=3,"4"=4,"5"=4, "6"=5 ))

Mali_baseline_2018$HHHEdu <- labelled::labelled(Mali_baseline_2018$HHHEdu, c(Aucune = 1, `Alphabétisé ou Coranique` = 2, Primaire= 3, Secondaire=4, Superieur=5))


#check labels (nouveau label)
expss::val_lab(Mali_baseline_2018$HHHEdu)

#Aucune  Alphabétisé ou Coranique     Primaire    Secondaire  Superieur 
# 1             2                        3            4          5 

Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,HHHEdu)



###########################################Mali_ea_2020 non traitée

expss::val_lab(Mali_ea_2020$HHHEdu)
#NULL
unique(Mali_ea_2020$HHHEdu)
# 1 2 3 4 5 6 7 8 9

# Mali_ea_2020 <- Mali_ea_2020 %>%
#   dplyr::mutate(HHHEdu = case_when(
#     HHHEdu == "Aucune Instruction" ~ "1",
#     HHHEdu == "Coranique" ~ "2",
#     HHHEdu == "Primaire" ~ "3",
#     HHHEdu == "Secondaire" ~ "4",
#     HHHEdu ==  "Supérieur" ~ "5",
#     .default = NA
#   ))


# Mali_ea_2020$HHHEdu <- Mali_ea_2020 %>% dplyr::mutate(HHHEdu = dplyr::recode(HHHEdu,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5))
# 
# Mali_ea_2020$HHHEdu <- labelled::labelled(Mali_ea_2020$HHHEdu, c(Aucune = 1, `Alphabétisé ou Coranique` = 2, Primaire= 3,Secondaire=4, Superieur=5))
# expss::val_lab(Mali_ea_2020$HHHEdu)


################################################################# Le recodage ne prend pas ###############################################################################

expss::val_lab(Mali_ea_2021$HHHEdu)

Mali_ea_2021 <- 
  Mali_ea_2021%>% dplyr::mutate(HHHEdu = dplyr::recode(HHHEdu,"0"=1,"1"=2,"2"=3,"3"=4,"4"=4,"5"=5 ))

Mali_ea_2021$HHHEdu <- labelled::labelled(Mali_ea_2021$HHHEdu, c(Aucune = 1, `Alphabétisé ou Coranique` = 2, Primaire= 3, Secondaire=4, Superieur=5))

expss::val_lab(Mali_ea_2021$HHHEdu)
##################################################################"
################################################################"


expss::val_lab(Mali_ea_2022$HHHEdu)

#NULL

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate(HHHEdu = dplyr::recode(HHHEdu,"Aucun"=1,"Alphabétisé ou Coranique"=2,"1er cycle fondamentale"=3,"2e cycle fondamentale"=4, "Secondaire"=4,"Supérieur"=5))

Mali_ea_2022$HHHEdu <- labelled::labelled(Mali_ea_2022$HHHEdu, c(Aucune = 1, `Alphabétisé ou Coranique` = 2, Primaire= 3,Secondaire=4, Superieur=5))

expss::val_lab(Mali_ea_2022$HHHEdu)
##


expss::val_lab(Mali_pdm_2022$HHHEdu)
#NULL

unique(Mali_pdm_2022$HHHEdu)
#NA : var HHHEdu est vide dans la base Mali_pdm_2022

```


# HHHMainActivity

```{r}
expss::val_lab(Mali_baseline_2018$HHHMainActivity)
#NULL

Mali_baseline_2018 %>% 
  plot_frq(coord.flip =T,HHHMainActivity)


expss::val_lab(Mali_ea_2020$HHHMainActivity)
#NULL


expss::val_lab(Mali_ea_2021$HHHMainActivity)
#NULL

Mali_ea_2020 %>% 
  plot_frq(coord.flip =T,HHHMainActivity)

expss::val_lab(Mali_ea_2022$HHHMainActivity)
#NULL

expss::val_lab(Mali_pdm_2022$HHHMainActivity)
#NULL

```

# HHHMatrimonial

```{r}
# Monogame    Polygame     Divorcé(e)   Veuf/Veuve    Célibataire 
#   1           2           3              4           5 
expss::val_lab(Mali_baseline_2018$HHHMatrimonial)
# Aucun  Marié monogame  Marié polygame Divorcé /Séparé      Veuf/Veuve  Célibataire
#  0               1               2               3               4         5
               


Mali_baseline_2018 <- 
  Mali_baseline_2018 %>% dplyr::mutate(HHHMatrimonial = dplyr::recode(HHHMatrimonial,"0"=5,"1"=1,"2"=2,"3"=3,"4"=4,"5"=4,"5"=5))

Mali_baseline_2018$HHHMatrimonial <- labelled::labelled(Mali_baseline_2018$HHHMatrimonial, c(Monogame = 1, Polygame = 2, `Divorcé(e)`= 3,`Veuf/Veuve`=4, `Célibataire`=5))

expss::val_lab(Mali_baseline_2018$HHHMatrimonial)
#   Monogame    Polygame  Divorcé(e)  Veuf/Veuve Célibataire 
#          1           2           3           4           5 



expss::val_lab(Mali_ea_2020$HHHMatrimonial)
#NULL


Mali_ea_2020 <- 
  Mali_ea_2020 %>% dplyr::mutate(HHHMatrimonial = dplyr::recode(HHHMatrimonial,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5))

Mali_ea_2020$HHHMatrimonial <- labelled::labelled(Mali_ea_2020$HHHMatrimonial, c(Monogame = 1, Polygame = 2, `Divorcé(e)`= 3,`Veuf/Veuve`=4, `Célibataire`=5))

expss::val_lab(Mali_ea_2020$HHHMatrimonial)
#####


expss::val_lab(Mali_ea_2021$HHHMatrimonial)
#Marié(e) monogame  Marié(e) polygame   Séparé(e)/Divorcé(e)  Veuf/Veuve  Célibataire 
#          1           2                          3                 4           5
# Union libre ou concubinage
#                   6



Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate(HHHMatrimonial = dplyr::recode(HHHMatrimonial,"1"=1,"2"=2,"3"=3,"4"=4,"5"=5,"6"=5))

Mali_ea_2021$HHHMatrimonial <- labelled::labelled(Mali_ea_2021$HHHMatrimonial, c(Monogame = 1, Polygame = 2, `Divorcé(e)`= 3,`Veuf/Veuve`=4, `Célibataire`=5))

expss::val_lab(Mali_ea_2021$HHHMatrimonial)

#Monogame    Polygame  Divorcé(e)  Veuf/Veuve Célibataire 
#    1           2           3           4           5 


####
expss::val_lab(Mali_ea_2022$HHHMatrimonial)
#NULL

Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate(HHHMatrimonial = dplyr::recode(HHHMatrimonial,"Marié(e) monogame"=1,"Marié(e) polygame"=2,"Séparé(e)/Divorcé(e)"=3,"Veuf/Veuve"=4,"Célibataire"=5, "Union libre ou concubinage"=5))

Mali_ea_2022$HHHMatrimonial <- labelled::labelled(Mali_ea_2022$HHHMatrimonial, c(Monogame = 1, Polygame = 2, `Divorcé(e)`= 3,`Veuf/Veuve`=4, `Célibataire`=5))

expss::val_lab(Mali_ea_2022$HHHMatrimonial) #OK


##

expss::val_lab(Mali_pdm_2022$HHHMatrimonial)
#NULL

unique(Mali_pdm_2022$HHHMatrimonial)
#NA var HHHMatrimonial de Mali_pdm_2022 est vide

```


# HHSourceIncome

```{r}
expss::val_lab(Mali_baseline_2018$HHSourceIncome)
#NULL
unique(Mali_baseline_2018$HHSourceIncome)
#NA var HHSourceIncome de Mali_baseline_2018 est vide

expss::val_lab(Mali_ea_2020$HHSourceIncome)
#NULL
unique(Mali_ea_2020$HHSourceIncome)
#NA var HHSourceIncome de Mali_ea_2020 est vide


expss::val_lab(Mali_ea_2021$HHSourceIncome)
#label existe
#30 occurences, ne sait pas comment harmoniser label


expss::val_lab(Mali_ea_2022$HHSourceIncome)
#NULL
# 2 1 3 0
#  0    1    2    3 
# 12 1126  709   55 

expss::val_lab(Mali_pdm_2022$HHSourceIncome)
#NULL
#Vide
```


# Assistance

## Date assistance check
```{r}
unique(Mali_baseline_2018$DebutAssistance)
#Vide
```


```{r}
unique(Mali_ea_2020$DebutAssistance)
#Vide
```

```{r}
unique(Mali_ea_2021$DebutAssistance)
#date est dans le bon format : "2021-08-12" "2021-11-26" "2021-08-02"
```

```{r}
unique(Mali_ea_2022$DebutAssistance) #"43964" "44002"

Mali_ea_2022$DebutAssistance<-as.Date(as.numeric(Mali_ea_2022$DebutAssistance), origin = "1899-12-30")
```

```{r}
unique(Mali_pdm_2022$DebutAssistance)
#as.Date(Mali_pdm_2022$DebutAssistance, origin = "1970-01-01") #"2090-04-04"
#as.Date(Mali_pdm_2022$DebutAssistance, origin = "1899-12-30") #"2020-04-02"

Mali_pdm_2022$DebutAssistance<-as.Date(Mali_pdm_2022$DebutAssistance, origin = "1899-12-30")

```


## Date last assistance check

```{r}
expss::val_lab(Mali_baseline_2018$DateDerniereAssist)
#NULL
#VIDE

expss::val_lab(Mali_ea_2020$DateDerniereAssist)
#NULL
#VIDE


expss::val_lab(Mali_ea_2021$DateDerniereAssist)

#Moins d'une semaine    entre 1 et 3 semaines    plus de 3 semaines      Other
 #      "1"                   "2"                          "3"          "other"

Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)


Mali_ea_2021 <- 
  Mali_ea_2021 %>% dplyr::mutate_at(c("DateDerniereAssist"),recode," "=NA_real_,"1"=1,"2"=2,"3"=3,"other"=NA_real_)

Mali_ea_2021$DateDerniereAssist <- labelled::labelled(Mali_ea_2021$DateDerniereAssist, c(`moins d’une semaine` = 1, `entre 1 et 3 semaines` = 2,`plus de 3 semaines`=3))

Mali_ea_2021 %>% 
  plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)

####

expss::val_lab(Mali_ea_2022$DateDerniereAssist)
#NULL

#"plus de 3 semaines"    "Other "entre 1 et 3 semaines" "Moins d'une semaine"

Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)


Mali_ea_2022 <- 
  Mali_ea_2022 %>% dplyr::mutate_at(c("DateDerniereAssist"),recode,"Moins d'une semaine"=1,"entre 1 et 3 semaines"=2,"plus de 3 semaines"=3,"Other"=NA_real_)

Mali_ea_2022$DateDerniereAssist <- labelled::labelled(Mali_ea_2022$DateDerniereAssist, c(`moins d’une semaine` = 1, `entre 1 et 3 semaines` = 2,`plus de 3 semaines`=3))


expss::val_lab(Mali_ea_2022$DateDerniereAssist)

Mali_ea_2022 %>% 
  plot_frq(coord.flip =T,DateDerniereAssist,show.na =T) # revoir le NA_real là

##
expss::val_lab(Mali_pdm_2022$DateDerniereAssist)
#NULL

Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)

Mali_pdm_2022 <- 
  Mali_pdm_2022 %>% dplyr::mutate_at(c("DateDerniereAssist"),recode,"Moins d'une semaine"=1,"entre 1 et 3 semaines"=2,"plus de 3 semaines"=3,"Other"=NA_real_)

Mali_pdm_2022$DateDerniereAssist <- labelled::labelled(Mali_pdm_2022$DateDerniereAssist, c(`moins d’une semaine` = 1, `entre 1 et 3 semaines` = 2,`plus de 3 semaines`=3))

Mali_pdm_2022 %>% 
  plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)


```



## Type d'assistance

```{r eval=FALSE, include=FALSE}
var_type_assistance = c("BanqueCerealiere",
"VivreContreTravail",
"ArgentContreTravail",
"DistribVivresSoudure",
"DistribArgentSoudure",
"BoursesAdo",
"BlanketFeedingChildren",
"BlanketFeedingWomen",
"MAMChildren",
"MASChildren",
"MAMPLWomen",
"FARNcommunaut",
"FormationRenfCapacite",
"CashTransfert",
"CantineScolaire"
)

#1=Oui PAM 2=Oui, Autre 3=NSP

df <-Mali_baseline_2018 %>%
  dplyr::select(var_type_assistance) # need discussion, missing

all(sapply(df, function(col) all(is.na(col))))


#les var_type_assistance sont vides dans Mali_baseline_2018 

d <-Mali_ea_2020 %>%
  dplyr::select(var_type_assistance)

all(sapply(d, function(col) all(is.na(col))))
expss::val_lab(d$CantineScolaire)
#NULL

#la seule var non vide parmi var_type_assistance dans Mali_ea_2020 est CantineScolaire  


d2 <-Mali_ea_2021 %>%
  dplyr::select(var_type_assistance) #ok

expss::val_lab(d2$CantineScolaire)

# Oui, PAM       Oui, Autre       Ne Sait Pas   NA 
#    1                2               3 


#all(sapply(d2, function(col) all(is.na(col))))
#FALSE

names(which(sapply(d2, function(col) all(is.na(col)))))
#"FARNcommunaut"
#Les var_type_assistance sont bien labelisées dans la base Mali_ea_2021 sauf FARNcommunaut


d3 <-Mali_ea_2022 %>%
  dplyr::select(var_type_assistance) # need questionnaire

all(sapply(d3, function(col) all(is.na(col))))
#FALSE

expss::val_lab(d3$CantineScolaire)
#NULL
#"FARNcommunaut"
names(which(sapply(d3, function(col) all(is.na(col)))))

#Toutes les var_type_assistance sauf FARNcommunaut ont pour valeur "Ne Sait Pas" "Oui, Autre" "Oui, PAM" dans la base Mali_ea_2022



d4 <-Mali_pdm_2022 %>%
  dplyr::select(var_type_assistance) # need discussion

all(sapply(d4, function(col) all(is.na(col))))
#FALSE

names(which(sapply(d4, function(col) all(is.na(col)))))
#"FARNcommunaut"
#Toutes les var_type_assistance sauf FARNcommunaut ont pour valeur "Ne Sait Pas" "Oui, Autre" "Oui, PAM" dans la base Mali_pdm_2022


```



```{r}
unique(Mali_baseline_2018$LhCSIEmergency1)
```


# Merging all data

```{r WFP Mali data}

Mali_baseline_2018 <- labelled::to_factor(Mali_baseline_2018)
Mali_ea_2020 <- labelled::to_factor(Mali_ea_2020)
Mali_ea_2021 <- labelled::to_factor(Mali_ea_2021)
Mali_ea_2022 <- labelled::to_factor(Mali_ea_2022)
Mali_pdm_2022 <- labelled::to_factor(Mali_pdm_2022)


WFP_Mali<-plyr::rbind.fill(Mali_baseline_2018,
Mali_ea_2020,
Mali_ea_2021,
Mali_ea_2022,
Mali_pdm_2022)

```


```{r}
unique(WFP_Mali$LhCSIEmergency1)
```


```{r variables reorder}

WFP_Mali.sub<- WFP_Mali  %>% dplyr::select(ID,adm0_ocha,ADMIN0Name,adm1_ocha,ADMIN1Name,adm2_ocha,ADMIN2Name,SURVEY,YEAR,SvyDatePDM,HHHSex ,HHHAge, HHHEdu,everything())

WFP_Mali <- copy_labels(WFP_Mali.sub, WFP_Mali)
#

```



# Cleaning dirty variables


## drop variables not needed

```{r variables not needed}
var_to_drop = c("RESPConsent",
                "ADMIN3Name",
                "RESPAge",
                "RESPSex",
                #"RelationWith_HHH",
                "HHHMainActivity",
                #"HHHMatrimonial",
                "HHSourceIncome"
)

WFP_Mali <- WFP_Mali  %>% dplyr::select(-var_to_drop)
```

## Remove empty rows and/or columns

```{r Remove empty rows and  columns, eval=FALSE, include=FALSE}
WFP_Mali <- WFP_Mali  %>% janitor::remove_empty()

```

## Remove constant columns

```{r Remove constant columns, eval=FALSE, include=FALSE}
WFP_Mali <- WFP_Mali  %>% janitor::remove_constant()
```


# Data exportation 

## Variables labels

```{r eval=FALSE, include=FALSE}
#var_label(penguins) <- penguins_metadata |> pull(variable_label)
#https://www.pipinghotdata.com/posts/2022-09-13-the-case-for-variable-labels-in-r/
# Chad_Harmonization_variables_labels <- read_excel(paste0(dir_input_data,"/Chad_Harmonization.xlsx"), 
#     sheet = "variables_labels")
# 
# variable_to_labels = intersect(Chad_Harmonization_variables_labels$Variable_Name,names(WFP_Chad.sub))
# WFP_Chad.sub_metadata <- tribble(
#     ~variable,           ~variable_label, 
#     Chad_Harmonization_variables_labels$Variable_Name,   Chad_Harmonization_variables_labels$Variable_Label
# )
# WFP_Chad.sub_labels <- WFP_Chad.sub_metadata |> 
#   deframe()
# 
# df=WFP_Chad.sub |> dplyr::select(variable_to_labels)
# WFP_Chad.sub_labelled <-  df |>
#   set_variable_labels(!!!WFP_Chad.sub_labels)
```




```{r}
#WFP_Mali <- labelled::to_factor(as.numeric(as.character(WFP_Mali)))
#WFP_Mali = as.data.frame(WFP_Mali)
```

```{r}
haven::write_dta(WFP_Mali,"C:/Users/ASUS/Desktop/ISEP 3/Statistique exploratoire spatiale/Projet_1/Data/output_data/WFP_Mali.dta")
```

```{r eval=FALSE, include=FALSE}
#WFP_Chad<- WFP_Chad %>% janitor::clean_names()
# WFP_Chad_bis <- WFP_Chad
# for (colname in names(WFP_Chad_bis)) {
#   if (is.character(WFP_Chad_bis[[colname]])) {
#     WFP_Chad_bis[[colname]] <- as.factor(WFP_Chad_bis[[colname]])
#   }
# }
```





```{r}
# WFP_Chad_dictionary <- WFP_Chad |> 
#   generate_dictionary()
# WFP_Chad_dictionary |> 
#   knitr::kable()
```


```{r}
#devtools::install_github("pcctc/croquet")
library(croquet)
library(openxlsx)

wb <- createWorkbook()
add_labelled_sheet(WFP_Mali)
saveWorkbook(wb, "C:/Users/ASUS/Desktop/ISEP 3/Statistique exploratoire spatiale/Projet_1/Data/output_data/WFP_Mali.xlsx",overwrite = TRUE)
```



```{r remove final environment variables}
rm(list = ls())
```
